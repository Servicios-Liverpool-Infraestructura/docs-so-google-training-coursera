
<!DOCTYPE html>
<html lang='en'>
<head>
<title>Reporting Application Metrics into Cloud Monitoring | Qwiklabs</title>
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"DANIEL","lastname":"ENRIQUE SANDOVAL SANCHEZ","fullname":"DANIEL ENRIQUE SANDOVAL SANCHEZ","company":"Coursera","email":"desandovals@liverpool.com.mx","origin":"googlecoursera-run, lti-coursera","subscriptions":0,"id":"40414ff5fc280f833d9acca966912f93","qlCreatedAt":"2020-11-17 20:45:59 UTC","optIn":null,"current_organization_id":null,"current_organization_role":null};gon.segment="j4Im8pqIko0Lxq4wVVZWMPMM0EroHUvb";gon.deployment="run";gon.content={"type":"Lab","id":1047,"name":"Reporting Application Metrics into Cloud Monitoring"};
//]]>
</script>
<script>
  dataLayer = [
    {user: gon.current_user},
    {content: gon.content}
  ];
</script>
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-TQR88QK");
</script>
<script>
  EVENT_SOURCE_BASE_URL = "https://run.qwiklabs.com/nchan-sub?id=";
</script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/polyfills/webcomponents-loader-408088dc333247a761de5f2b2a4ba1cabd2bc36579f83ba92a559eb3682a9b77.js"></script>
<script src="https://cdn.qwiklabs.com/assets/vendor-45d462772c30000424907184f70c7157e95fb6227698d1671c5051818a6f60d8.js"></script>
<script src="https://cdn.qwiklabs.com/assets/application-034d6698d9e8e4069d310e418a7827442046e71025a0e336e0896055be8a1153.js"></script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/hallofmirrors-b1177b2da0d0a4d1b239b0364e70f5a598873a2b8fb44c288c9428709123506c.js"></script>
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script type='application/ld+json'>
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>


<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="MwLSCyl6Pt2rLcntOy/12IwLgjZIOfiV3k/gvq3e2ZGjjMU6CZEogEnlpuKZRCtLD2gzMDObJpzGqv9WrHKJpQ==" />
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0' name='viewport'>
<meta content='1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0' name='google-site-verification'>
<meta content='#3681E4' property='msapplication-TileColor'>
<meta content='/favicon-144.png' property='msapplication-TileImage'>
<meta content='[{&quot;id&quot;:&quot;recaptcha_experiment&quot;,&quot;optimize_id&quot;:&quot;dpViOcLkT3qS4TvL2mRojA&quot;,&quot;title&quot;:&quot;No Recaptcha shown for trusted users&quot;,&quot;variant_index&quot;:0,&quot;variant&quot;:&quot;original&quot;}]' name='active-experiments'>
<meta content='{&quot;userId&quot;:3894861}' name='help-api-product-data'>
<meta content='In this lab you will run an application on Compute Engine instance and report the application’s metrics into Cloud Monitoring using the OpenCensus library.' name='description'>
<meta content='Qwiklabs' name='author'>
<meta content='Reporting Application Metrics into Cloud Monitoring | Qwiklabs' property='og:title'>
<meta content='website' property='og:type'>
<meta content='/favicon-144.png' property='og:image'>
<meta content='Qwiklabs' property='og:site_name'>
<meta content='In this lab you will run an application on Compute Engine instance and report the application’s metrics into Cloud Monitoring using the OpenCensus library.' property='og:description'>
<meta content='/qwiklabs_logo_900x887.png' property='og:logo' size='900x887'>
<meta content='/qwiklabs_logo_994x187.png' property='og:logo' size='994x187'>


<link href='/favicon-32.png' rel='shortcut icon'>
<link color='#3681E4' href='/favicon-svg.svg' rel='mask-icon'>
<link href='/favicon-180.png' rel='apple-touch-icon-precomposed'>



<link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Oswald:400|Roboto+Mono:400,700|Roboto:300,400,500,700|Google+Sans:300,400,500,700|Google+Sans+Display:400|Material+Icons|Google+Material+Icons" />


<link rel="stylesheet" media="all" href="https://cdn.qwiklabs.com/assets/application-3b0f6c441394eebd52ff10f04fb2923fdb7b1b4fec780e7fa8ef67f5dd2ef411.css" />



</head>
<body class='lab-show l-full no-nav application-new focuses focuses-show lab-show l-full no-nav '>
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-TQR88QK' style='display:none;visibility:hidden;' width='0'></iframe>
</noscript>
<span class='hidden' id='flash-sibling-before'></span>

<div class='header-container light-theme'>
<div class='header'>
<ql-icon-button class='js-nav-toggle header__nav-panel-button l-mrm'>menu</ql-icon-button>
<div class='header__title'>
<ql-icon-button label="Back" href="https://www.qwiklabs.com/quests/143" id="2691f106bccda7b7" target="_self">arrow_back</ql-icon-button><div class="mdl-tooltip" data-mdl-for="2691f106bccda7b7">Back</div>

<h1 class='headline-5'>
Reporting Application Metrics into Cloud Monitoring
</h1>
</div>
<div class='header__actions'>
<ql-icon-button class='header__button--search js-header-search-bar-button'>search</ql-icon-button>
<ql-icon-button id='share_1047'>share</ql-icon-button>
<ql-menu for='share_1047'>
<ql-menu-item>
<a data-analytics-action="Shared to LinkedIn." data-analytics-category="Lab" data-analytics-label="Reporting Application Metrics into Cloud Monitoring" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.qwiklabs.com%2Fcatalog_lab%2F1047%3Futm_medium%3Dsocial%26utm_source%3Dlinkedin%26utm_campaign%3Dql-social-share"><ql-icon class='l-mrs'>post_linkedin</ql-icon>
LinkedIn
</a>
</ql-menu-item>
<ql-menu-item>
<a data-analytics-action="Shared to Twitter." data-analytics-category="Lab" data-analytics-label="Reporting Application Metrics into Cloud Monitoring" target="_blank" href="https://twitter.com/intent/tweet?text=Learn%20cloud%20tech%20through%20hands-on%20training%20on%20%23Qwiklabs%21&amp;url=https%3A%2F%2Fwww.qwiklabs.com%2Fcatalog_lab%2F1047%3Futm_medium%3Dsocial%26utm_source%3Dtwitter%26utm_campaign%3Dql-social-share&amp;hashtags="><ql-icon class='l-mrs'>post_twitter</ql-icon>
Twitter
</a>
</ql-menu-item>
<ql-menu-item>
<a data-analytics-action="Shared to Facebook." data-analytics-category="Lab" data-analytics-label="Reporting Application Metrics into Cloud Monitoring" target="_blank" href="https://facebook.com/sharer.php?display=popup&amp;u=https%3A%2F%2Fwww.qwiklabs.com%2Fcatalog_lab%2F1047%3Futm_medium%3Dsocial%26utm_source%3Dfacebook%26utm_campaign%3Dql-social-share"><ql-icon class='l-mrs'>post_facebook</ql-icon>
Facebook
</a>
</ql-menu-item>
<ql-menu-item>
<ql-copyable-input label='Share Link' value='https://www.qwiklabs.com/catalog_lab/1047'></ql-copyable-input>
</ql-menu-item>
</ql-menu>

<a class="icon-button js-favorite-button favorite-button" id="CatalogItem-1259-favorite-button" data-type="CatalogItem" data-id="1259" data-name="Reporting Application Metrics into Cloud Monitoring" href="/favorite.json?item_id=1259&amp;item_type=CatalogItem"><ql-icon>favorite_border</ql-icon>
</a><div class='mdl-tooltip js-tooltip' for='CatalogItem-1259-favorite-button'>
Add to favorites
</div>



<ql-icon-button id='control-panel-target' style='display: none;'>
dashboard
</ql-icon-button>
<ql-menu for='control-panel-target' id='control-panel-menu'></ql-menu>

<ql-icon-button id='help-menu-button'>help</ql-icon-button>
<div class='mdl-tooltip js-tooltip' data-mdl-for='help-menu-button'>
Help
</div>
<ql-menu for='help-menu-button' id='help-menu'>
<ql-menu-item>
<ql-help context='lab' data-analytics-action='opened_help' data-analytics-label='lab' productdata='{&quot;userId&quot;:3894861}'>
Help Center
</ql-help>
</ql-menu-item>
<ql-menu-item>
<a target="_blank" class="ql-body-1" href="https://support.google.com/qwiklabs/contact/contact_us">Email support</a>
</ql-menu-item>
</ql-menu>

<ql-icon-button id='language'>language</ql-icon-button>
<div class='mdl-menu mdl-menu__bottom-right mdl-js-menu elevation-3' for='language'>
<a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ar" href="/focuses/1259?locale=ar&amp;parent=catalog">العربية‬‎
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="de" href="/focuses/1259?locale=de&amp;parent=catalog">Deutsch
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="en" href="/focuses/1259?locale=en&amp;parent=catalog">English
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="es" href="/focuses/1259?locale=es&amp;parent=catalog">español (Latinoamérica)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="fr" href="/focuses/1259?locale=fr&amp;parent=catalog">français
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="id" href="/focuses/1259?locale=id&amp;parent=catalog">bahasa Indonesia
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="it" href="/focuses/1259?locale=it&amp;parent=catalog">Italiano
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ja" href="/focuses/1259?locale=ja&amp;parent=catalog">日本語
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ko" href="/focuses/1259?locale=ko&amp;parent=catalog">한국어
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pl" href="/focuses/1259?locale=pl&amp;parent=catalog">Polski
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_BR" href="/focuses/1259?locale=pt_BR&amp;parent=catalog">português (Brasil)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_PT" href="/focuses/1259?locale=pt_PT&amp;parent=catalog">português (Portugal)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ru" href="/focuses/1259?locale=ru&amp;parent=catalog">русский
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="tr" href="/focuses/1259?locale=tr&amp;parent=catalog">Türkçe
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh" href="/focuses/1259?locale=zh&amp;parent=catalog">简体中文
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh_TW" href="/focuses/1259?locale=zh_TW&amp;parent=catalog">繁體中文
</a></div>
<button class='icon-button' id='my_account'>
<ql-avatar src='https://lh3.googleusercontent.com/a-/AOh14Gh6Bmcr7vfcCi5iPAH2qDeJgSaD6RLv1Muiv9mceA=s320-c'></ql-avatar>
</button>
<ql-menu for='my_account' open>
<div class='my-account-menu'>
<ql-avatar class='l-mtl l-mbl' size='120' src='https://lh3.googleusercontent.com/a-/AOh14Gh6Bmcr7vfcCi5iPAH2qDeJgSaD6RLv1Muiv9mceA=s320-c'></ql-avatar>
<div class='my-account-menu__user-info l-mbl'>
<h4 class='ql-subhead-1'>DANIEL ENRIQUE SANDOVAL SANCHEZ</h4>
<p class='ql-body-2 text--light'>desandovals@liverpool.com.mx</p>
<p class='ql-body-2 text--light'>
</p>
<a class="text--green ql-subhead-2" href="/my_account/payments"><ql-chip positive>
1945 Credits
</ql-chip>
</a></div>
<div class='buttons l-mbl'>
<a class="button button--hairline" id="settings" href="/my_account/profile">Settings</a>
</div>
<hr>
<ql-button data-analytics-action='clicked_sign_out' href='/users/sign_out' method='delete'>
Sign Out
</ql-button>
<div class='privacy l-mtl'>
<a class="ql-caption text--light" href="/privacy_policy">Privacy</a>
<span class='ql-caption text--light l-mls l-mrs'>&middot;</span>
<a class="ql-caption text--light" href="/terms_of_service">Terms</a>
</div>
</div>
</ql-menu>

</div>
</div>
<div class='header__search-bar js-header-search-bar'>
<form class="js-search-form-mobile" onsubmit="ql.searchFilter(); return false;" action="/searches/elasticsearch" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="Jtrmn/dtp0EN+iFSBC6myaEuGCd3z48aYlkvXnqRB3C2VPGu14axHO8yTl2mRXhaIk2pIQxtURN6vDC2ez1XRA==" />
<input type="text" name="keywords" id="keywords" placeholder="Search" maxlength="255" aria-label="catalog search bar" />
</form>

<ql-icon-button class='js-close-search-bar'>close</ql-icon-button>
</div>
</div>

<nav class='nav-bar'>
<a class="nav-bar__item js-navigation-button" href="/"><ql-icon class='nav-bar__item__icon'>
home
</ql-icon>
<span class='nav-bar__item__label'>
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button  active" aria-current="page" href="/catalog"><ql-icon class='nav-bar__item__icon'>
school
</ql-icon>
<span class='nav-bar__item__label'>
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="/my_learning"><ql-icon class='nav-bar__item__icon'>
event_note
</ql-icon>
<span class='nav-bar__item__label'>
My Learning
</span>
</a>
</nav>

<nav class='nav-panel js-nav-panel'>
<div class='nav-panel__logo'>
<div class='logo logo--blue'></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="/"><ql-icon class='nav-panel__item__icon'>
home
</ql-icon>
<div class='nav-panel__item__label'>
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button active" aria-current="page" href="/catalog"><ql-icon class='nav-panel__item__icon'>
school
</ql-icon>
<div class='nav-panel__item__label'>
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_learning"><ql-icon class='nav-panel__item__icon'>
event_note
</ql-icon>
<div class='nav-panel__item__label'>
My Learning
</div>
</a>
<div class='nav-panel__spacer'></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/profile"><ql-icon class='nav-panel__item__icon'>
account_circle
</ql-icon>
<div class='nav-panel__item__label'>
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/credits"><ql-icon class='nav-panel__item__icon'>
money
</ql-icon>
<div class='nav-panel__item__label'>
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/security"><ql-icon class='nav-panel__item__icon'>
security
</ql-icon>
<div class='nav-panel__item__label'>
Security
</div>
</a>
<div class='nav-panel__spacer'></div>
<a class="nav-panel__item" tabindex="-1" href="#"><ql-help>
<div class='nav-panel__help-item'>
<ql-icon class='nav-panel__item__icon'>help</ql-icon>
<div class='nav-panel__item__label'>
Help
</div>
</div>
</ql-help>
</a><div class='nav-panel__small-links'>
<a tabindex="-1" href="/privacy_policy">Privacy</a>
<a tabindex="-1" href="/terms_of_service">Terms</a>
</div>
</nav>
<div class='nav-panel__overlay js-nav-toggle'></div>

<main class='js-main'>
<div class='l-main-wrapper' id='main-wrapper'>







<div class='lab-assessment__tab js-open-lab-assessment-panel'>
<h6 class='js-lab-assessment-total-score'>
&mdash;/100
</h6>
</div>
<div class='lab-assessment__panel js-lab-assessment-panel'>
<div class='lab-assessment__panel__header'>
<h4>Checkpoints</h4>
<ql-icon-button class='js-close-lab-assessment-panel'>arrow_forward</ql-icon-button>
</div>
<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create a Compute Engine instance
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='1'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-1'>
</span>
/ 40
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create Monitoring workspace and install agents on the VM
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='2'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-2'>
</span>
/ 30
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
View your application metrics in Cloud Monitoring
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='3'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-3'>
</span>
/ 30
</p>
</div>
</div>

</div>
<ql-drawer-container class='js-lab-state' data-analytics-payload='{&quot;label&quot;:&quot;Reporting Application Metrics into Cloud Monitoring&quot;,&quot;lab_name&quot;:&quot;Reporting Application Metrics into Cloud Monitoring&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;run&quot;}' data-focus-id='1259' data-lab-billing-limit='0.0' data-lab-duration='5400' data-parent='catalog' data-payment-required data-recaptcha-enabled id='lab-container'>
<ql-drawer id='terminal-drawer' slot='drawer' style='width: calc(100% - 480px)'>
<iframe allow='clipboard-read' class='terminal' id='embedded-resource'></iframe>
</ql-drawer>
<ql-drawer-content class='js-lab-wrapper' id='lab-content' slot='drawer-content'>
<ql-drawer-container id='lab-content-container'>
<ql-drawer id='control-panel-drawer' open slot='drawer' width='320'>
<ql-lab-control-panel class='ql-lab-control-panel__max-height control-panel js-lab-control-panel' connectionFiles='[]' labControlButton='{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}' labDetails='[]' labTimer='{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:5400}' studentResources='[]'>
<script src="https://www.recaptcha.net/recaptcha/api.js?render=6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr"   ></script>
        <script>
          // Define function so that we can call it again later if we need to reset it
          // This executes reCAPTCHA and then calls our callback.
          function executeRecaptchaForStartLab() {
            grecaptcha.ready(function() {
              grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}).then(function(token) {
                setInputWithRecaptchaResponseTokenForStartLab('g-recaptcha-response-data-start-lab', token)
              });
            });
          };
          // Invoke immediately
          executeRecaptchaForStartLab()

          // Async variant so you can await this function from another async function (no need for
          // an explicit callback function then!)
          // Returns a Promise that resolves with the response token.
          async function executeRecaptchaForStartLabAsync() {
            return new Promise((resolve, reject) => {
              grecaptcha.ready(async function() {
                resolve(await grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}))
              });
            })
          };

                    var setInputWithRecaptchaResponseTokenForStartLab = function(id, token) {
            var element = document.getElementById(id);
            element.value = token;
          }

        </script>
<input type="hidden" name="g-recaptcha-response-data[start_lab]" id="g-recaptcha-response-data-start-lab" data-sitekey="6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr" class="g-recaptcha g-recaptcha-response "/>

<div class='hidden' id='recaptcha-v2-start-lab' slot='recaptcha'>
<script src="https://www.recaptcha.net/recaptcha/api.js" async defer ></script>
<div data-sitekey="6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV" data-callback="recaptchaComplete" data-expired-callback="expireV2Token" class="g-recaptcha "></div>
          <noscript>
            <div>
              <div style="width: 302px; height: 422px; position: relative;">
                <div style="width: 302px; height: 422px; position: absolute;">
                  <iframe
                    src="https://www.recaptcha.net/recaptcha/api/fallback?k=6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV"
                    name="ReCAPTCHA"
                    style="width: 302px; height: 422px; border-style: none; border: 0; overflow: hidden;">
                  </iframe>
                </div>
              </div>
              <div style="width: 300px; height: 60px; border-style: none;
                bottom: 12px; left: 25px; margin: 0px; padding: 0px; right: 25px;
                background: #f9f9f9; border: 1px solid #c1c1c1; border-radius: 3px;">
                <textarea id="g-recaptcha-response" name="g-recaptcha-response"
                  class="g-recaptcha-response"
                  style="width: 250px; height: 40px; border: 1px solid #c1c1c1;
                  margin: 10px 25px; padding: 0px; resize: none;">
                </textarea>
              </div>
            </div>
          </noscript>

</div>
</ql-lab-control-panel>
</ql-drawer>
<ql-drawer-content id='lab-instructions' slot='drawer-content'>
<div class='alert alert--fake js-alert'>
<p class='alert__message js-alert-message'></p>
<a class='alert__close js-alert-close'>
<i class='fa fa-times'></i>
</a>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='js-lab-content lab-content__renderable-instructions'>
<div class='lab-preamble'>
<h1 class='lab-preamble__title'>
Reporting Application Metrics into Cloud Monitoring
</h1>
<div class='lab-preamble__details subtitle-headline-1'>
<span>1 hour 30 minutes</span>
<span>5 Credits</span>
<div class='lab__rating'>
<a href="/focuses/1259/reviews?parent=catalog"><div class='rateit' data-rateit-readonly='true' data-rateit-value='3.9653'></div>

</a></div>
</div>
</div>

<div class='js-markdown-instructions markdown-lab-instructions' id='markdown-lab-instructions'>



<h2 id="step1">GSP111</h2>
<p><img alt="Google Cloud Self-Paced Labs" src="https://cdn.qwiklabs.com/GMOHykaqmlTHiqEeQXTySaMXYPHeIvaqa2qHEzw6Occ%3D"></p>

<h2 id="step2">Overview</h2>
<p>In this hands-on lab you setup a simple video server application in Go and instrument it to report application metrics, also known as <em>custom metrics</em>, to Cloud Monitoring using the OpenCensus library.</p>
<p>This lab has been adapted from the Go Cloud Monitoring exporter example on <a href="https://github.com/census-ecosystem/opencensus-go-exporter-stackdriver/blob/master/examples/stats/main.go" target="_blank"> GitHub</a>. OpenCensus refers to metrics as <em>stats</em>.</p>
<h2 id="step3">What is OpenCensus?</h2>
<p><a href="https://opencensus.io" target="_blank">OpenCensus</a> is an open source framework for metrics collection and distributed tracing. It offers the following benefits to its users:</p>
<ul>
<li>Low overhead data collection.</li>
<li>Standard wire protocols and consistent APIs for handling metrics and trace data.</li>
<li>Vendor interoperability via the OpenMetrics standard. OpenCensus can ingest into multiple backends in parallel, enabling incremental transitions and side-by-side comparison of backends.</li>
<li>Correlation with traces and, in the future, log entries.</li>
</ul>
<p>While multiple methods exist for reporting application metrics to Cloud Monitoring (see Other Methods for Reporting Application Metrics to Cloud Monitoring later in this lab), Google and Cloud Monitoring have adopted OpenCensus officially as the default mechanism for ingestion.</p>
<h2 id="step4">Setup and requirements</h2>
<h4>Before you click the Start Lab button</h4>
<p>Read these instructions. Labs are timed and you cannot pause them. The timer, which starts when you click <strong>Start Lab</strong>, shows how long Google Cloud resources will be made available to you.</p>
<p>This Qwiklabs hands-on lab lets you do the lab activities yourself in a real cloud environment, not in a simulation or demo environment. It does so by giving you new, temporary credentials that you use to sign in and access Google Cloud for the duration of the lab.</p>
<h4>What you need</h4>
<p>To complete this lab, you need:</p>
<ul>
<li>Access to a standard internet browser (Chrome browser recommended).</li>
<li>Time to complete the lab.</li>
</ul>
<p><strong>Note:</strong> If you already have your own personal Google Cloud account or project, do not use it for this lab.</p>
<p><strong>Note:</strong> If you are using a Pixelbook, open an Incognito window to run this lab.</p>

<h4>How to start your lab and sign in to the Google Cloud Console</h4>
<ol>
<li>
<p>Click the <strong>Start Lab</strong> button. If you need to pay for the lab, a pop-up opens for you to select your payment method.
On the left is a panel populated with the temporary credentials that you must use for this lab.</p>
<p><img alt="Open Google Console" src="https://cdn.qwiklabs.com/%2FtHp4GI5VSDyTtdqi3qDFtevuY014F88%2BFow%2FadnRgE%3D"></p>
</li>
<li>
<p>Copy the username, and then click <strong>Open Google Console</strong>.
The lab spins up resources, and then opens another tab that shows the <strong>Sign in</strong> page.</p>
<p><img alt="Sign in" src="https://cdn.qwiklabs.com/VkUIAFY2xX3zoHgmWqYKccRLwFrR4BfARLd5ojmlbhs%3D"></p>
<p><strong><em>Tip:</em></strong> Open the tabs in separate windows, side-by-side.</p>
<aside>
 If you see the <strong>Choose an account</strong> page, click <strong>Use Another Account</strong>.
<img alt="Choose an account" src="https://cdn.qwiklabs.com/eQ6xPnPn13GjiJP3RWlHWwiMjhooHxTNvzfg1AL2WPw%3D">
</aside>
</li>
<li>
<p>In the <strong>Sign in</strong> page, paste the username that you copied from the Connection Details panel. Then copy and paste the password.</p>
<p><strong><em>Important:</em></strong> You must use the credentials from the Connection Details panel. Do not use your Qwiklabs credentials. If you have your own Google Cloud account, do not use it for this lab (avoids incurring charges).</p>
</li>
<li>
<p>Click through the subsequent pages:</p>
<ul>
<li>Accept the terms and conditions.</li>
<li>Do not add recovery options or two-factor authentication (because this is a temporary account).</li>
<li>Do not sign up for free trials.</li>
</ul>
</li>
</ol>
<p>After a few moments, the Cloud Console opens in this tab.</p>
<aside>
<strong>Note:</strong> You can view the menu with a list of Google Cloud Products and Services by clicking the <strong>Navigation menu</strong> at the top-left.
<img alt="Cloud Console Menu" src="https://cdn.qwiklabs.com/9vT7xPlxoNP%2FPsK0J8j0ZPFB4HnnpaIJVCDByaBrSHg%3D">
</aside>

<h2 id="step5">Create a Compute Engine instance</h2>
<p>In this lab, you build an application on top of a vanilla Compute Engine virtual machine (VM).</p>
<p>In the Cloud Console, select <strong>Navigation menu</strong> &gt; <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>, then click <strong>Create Instance</strong>.</p>
<p>Set the following fields:</p>
<ul>
<li>
<p><strong>Name:</strong> my-opencensus-demo</p>
</li>
<li>
<p><strong>Region:</strong> us-central1 (Iowa)</p>
</li>
<li>
<p><strong>Zone:</strong> us-central1-a</p>
</li>
<li>
<p><strong>Series</strong>: N1</p>
</li>
<li>
<p><strong>Machine type:</strong> n1-standard-1 (1vCPU, 3.75 GB memory)</p>
</li>
<li>
<p><strong>Identity and API access</strong>: Select <strong>Set access for each API</strong>, then for <strong>Stackdriver Monitoring API</strong> select <strong>Full</strong> from the dropdown menu.</p>
</li>
<li>
<p><strong>Firewall:</strong> Select both <strong>Allow HTTP traffic</strong> and <strong>Allow HTTPS traffic</strong>.</p>
</li>
</ul>
<p>Leave the rest of the fields at their default values and click <strong>Create</strong>.</p>
<p>Click <strong>Check my progress</strong> to verify your performed task.</p>
<ql-activity-tracking step="1">
    Create a Compute Engine instance
</ql-activity-tracking>
<h2 id="step6">Install Go and OpenCensus on your instance</h2>
<p>When your new Compute Engine VM instance launches, click the <strong>SSH</strong> button in line with the instance to open an SSH terminal to your instance.</p>
<p>You will use the SSH terminal to install the following:</p>
<ul>
<li>Go</li>
<li>the git package</li>
<li>the OpenCensus package</li>
<li>the Cloud Monitoring OpenCensus exporter</li>
</ul>
<p>Execute the following commands in the SSH terminal:</p>
<pre><code class="language-bash prettyprint">sudo curl -O https://storage.googleapis.com/golang/go1.16.2.linux-amd64.tar.gz&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo tar -xvf go1.16.2.linux-amd64.tar.gz&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo rm -rf /usr/local/go&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo mv go /usr/local&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo apt-get update&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo apt-get install git&#x000A;</code></pre>
<p>You will be asked to confirm you want to continue - type in <strong>Y</strong>.</p>
<pre><code class="language-bash prettyprint">export PATH=$PATH:/usr/local/go/bin&#x000A;go get go.opencensus.io&#x000A;go get contrib.go.opencensus.io/exporter/stackdriver&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">go mod init test3&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">go mod tidy&#x000A;</code></pre>
<ql-infobox>
"go mod tidy" removes unused dependencies. You will get output <i>go: warning: "all" matched no packages</i> if you have no unused dependencies.
</ql-infobox>
<h3>Create a Monitoring workspace</h3>
<p>Now set up a Monitoring workspace that's tied to your Google Cloud Project. The following steps create a new account that has a free trial of Monitoring.</p>
<ol>
<li>
<p>In the Cloud Console, click <strong>Navigation menu</strong> &gt; <strong>Monitoring</strong>.</p>
</li>
<li>
<p>Wait for your workspace to be provisioned.</p>
</li>
</ol>
<p>When the Monitoring dashboard opens, your workspace is ready.</p>
<p><img alt="Overview.png" src="https://cdn.qwiklabs.com/FfS7W1mNXshxngUuea%2BFUBXoXedgDHt0YWk1aZKHiIk%3D"></p>

<p>Agents collect data and then send or stream info to Cloud Monitoring in the Cloud Console.</p>
<p>The <em>Cloud Monitoring agent</em> is a collectd-based daemon that gathers system and application metrics from virtual machine instances and sends them to Monitoring. By default, the Monitoring agent collects disk, CPU, network, and process metrics. Configuring the Monitoring agent allows third-party applications to get the full list of agent metrics. See <a href="https://cloud.google.com/monitoring/agent" target="_blank">Cloud Monitoring agent overview</a> for more information.</p>
<p>In this section, you install the <em>Cloud Logging agent</em> to stream logs from your VM instances to Cloud Logging. Later in this lab, you see what logs are generated when you stop and start your VM.</p>
<ql-infobox>
It is best practice to run the Cloud Logging agent on all your VM instances.
</ql-infobox>
<h4>Install agents on the VM:</h4>
<p>Run the following Monitoring agent install script command in the SSH terminal of your VM instance to install the <strong>Cloud Monitoring agent</strong>:</p>
<pre><code class="language-bash prettyprint">curl -sSO https://dl.google.com/cloudagents/add-monitoring-agent-repo.sh&#x000A;sudo bash add-monitoring-agent-repo.sh&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo apt-get update&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo apt-get install stackdriver-agent&#x000A;</code></pre>
<p>When asked if you want to continue, enter  <strong>Y</strong>.</p>
<p>Now run the Logging agent install script command in the SSH terminal of your VM instance to install the <strong>Cloud Logging agent</strong>:</p>
<pre><code class="language-bash prettyprint">curl -sSO https://dl.google.com/cloudagents/add-logging-agent-repo.sh&#x000A;sudo bash add-logging-agent-repo.sh&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo apt-get update&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">sudo apt-get install google-fluentd&#x000A;</code></pre>
<p>Click <strong>Check my progress</strong> to verify your performed task.</p>
<ql-activity-tracking step="2">
    Create Monitoring workspace and install agents on the VM
</ql-activity-tracking>
<h2 id="step7">Create a basic application server in Go</h2>
<p>Next, create a fake video server application that is going to check the size of its input queue every second and output that information to the console (you'll fake out the actual queue).</p>
<p>In the SSH window, open your favorite editor (<code>nano</code>, <code>vi</code>, etc.) to create into a file called <code>main.go</code> written in Go. For example:</p>
<pre><code>nano main.go&#x000A;</code></pre>
<p>Copy the following into your file:</p>
<pre><code class="language-bash prettyprint">package main&#x000A;&#x000A;import (&#x000A;        "fmt"&#x000A;        "math/rand"&#x000A;        "time"&#x000A;)&#x000A;&#x000A;func main() {&#x000A;        // Here's our fake video processing application. Every second, it&#x000A;        // checks the length of the input queue (e.g., number of videos&#x000A;        // waiting to be processed) and records that information.&#x000A;        for {&#x000A;                time.Sleep(1 * time.Second)&#x000A;                queueSize := getQueueSize()&#x000A;&#x000A;                // Record the queue size.&#x000A;                fmt.Println("Queue size: ", queueSize)&#x000A;        }&#x000A;}&#x000A;&#x000A;func getQueueSize() (int64) {&#x000A;        // Fake out a queue size here by returning a random number between&#x000A;        // 1 and 100.&#x000A;        return rand.Int63n(100) + 1&#x000A;}&#x000A;</code></pre>
<p>Save the file by pressing <strong>Ctrl + x</strong> and then <strong>Y</strong>.</p>
<p>Run the file with:</p>
<pre><code class="language-bash prettyprint">go run main.go&#x000A;</code></pre>
<p>You should see output like the following, with a new output line appearing every second:</p>
<pre><code class="language-bash prettyprint">Queue size: 11&#x000A;Queue size: 52&#x000A;...&#x000A;</code></pre>
<p>Use <strong>Ctrl</strong> + <strong>c</strong> to stop the output.</p>
<h2 id="step8">Defining &amp; recording measures using OpenCensus</h2>
<p>To put in place the basic infrastructure for propagating metrics (stats) via OpenCensus, you need to define a measure, record it, then set up a view that allows the measure to be collected and aggregated.</p>
<p>You'll do all of the above in a couple of steps added to the <code>main.go</code> file.</p>
<p>Open your <code>main.go</code> file in your text editor:</p>
<pre><code>nano main.go&#x000A;</code></pre>
<p>Start by defining and recording the measure.</p>
<p>Add the changes identified by <code>// [[Add this line]]</code> or <code>// [[Add this block]] … // [[End: add this block]]</code> to your file, then uncomment the added lines and remove the instructions:</p>
<pre><code class="language-bash prettyprint">package main&#x000A;&#x000A;import (&#x000A;"context" // [[Add this line]]&#x000A;"fmt"&#x000A;"math/rand"&#x000A;"time"&#x000A;&#x000A;"go.opencensus.io/stats"  // [[Add this line]]&#x000A;)&#x000A;&#x000A;// [[Add this block]]&#x000A;var videoServiceInputQueueSize = stats.Int64(&#x000A;"my.videoservice.org/measure/input_queue_size",&#x000A;"Number of videos queued up in the input queue",&#x000A;stats.UnitDimensionless)&#x000A;// [[End: add this block]]&#x000A;&#x000A;func main() {&#x000A;ctx := context.Background()  // [[Add: this line.]]&#x000A;&#x000A;// Here’s our fake video processing application. Every second, it&#x000A;// checks the length of the input queue (e.g., number of videos&#x000A;// waiting to be processed) and records that information.&#x000A;for {&#x000A;time.Sleep(1 * time.Second)&#x000A;queueSize := getQueueSize()&#x000A;&#x000A;// Record the queue size.&#x000A;// [[Add: next line.]]&#x000A;stats.Record(ctx, videoServiceInputQueueSize.M(queueSize)) // [[Add]]&#x000A;fmt.Println("Queue size: ", queueSize)&#x000A;}&#x000A;}&#x000A;&#x000A;func getQueueSize() (int64) {&#x000A;// Fake out a queue size here by returning a random number between&#x000A;// 1 and 100.&#x000A;return rand.Int63n(100) + 1&#x000A;}&#x000A;&#x000A;</code></pre>
<p>The <code>go.opencensus.io/stats</code> package contains all of the support you need to define and record measures.</p>
<p>In this example, <code>videoServiceInputQueueSize</code> is the measure. It's defined it as a 64-bit integer type. Each measure requires a name (the first parameter), a description, and a measurement unit.</p>
<p>A measure that has been defined also needs to be recorded. The <code>stats.Record(...)</code> statement sets the measure, <code>videoServiceInputQueueSize</code>, to the size queried, <code>queueSize</code>.</p>
<h2 id="step9">Setting up metrics collection &amp; aggregation</h2>
<p>Now that the metric is defined and being recorded, the next step is to enable collection and aggregation of the metric. We do this in OpenCensus by setting up a view.</p>
<p>Add the changes identified by <code>// [[Add this line]]</code> or <code>// [[Add this block]] … // [[End: add this block]]</code> to your <code>main.go</code> file, then uncomment the added lines and remove the instructions:</p>
<pre><code class="language-bash prettyprint">package main&#x000A;&#x000A;import (&#x000A;"context"&#x000A;"fmt"&#x000A;"log"  // [[Add this line]]&#x000A;"math/rand"&#x000A;"time"&#x000A;&#x000A;"go.opencensus.io/stats"&#x000A;"go.opencensus.io/stats/view"  // [[Add this line]]&#x000A;)&#x000A;&#x000A;var videoServiceInputQueueSize = stats.Int64(&#x000A;"my.videoservice.org/measure/input_queue_size",&#x000A;"Number of videos queued up in the input queue",&#x000A;stats.UnitDimensionless)&#x000A;&#x000A;func main() {&#x000A;ctx := context.Background()&#x000A;&#x000A;// [[Add this block]]&#x000A;// Setup a view so that we can export our metric.&#x000A;if err := view.Register(&amp;view.View{  // [[Add]]&#x000A;Name: "my.videoservice.org/measure/input_queue_size",&#x000A;Description: "Number of videos queued up in the input queue",&#x000A;Measure: videoServiceInputQueueSize,&#x000A;Aggregation: view.LastValue(),&#x000A;}); err != nil {&#x000A;log.Fatalf("Cannot setup view: %v", err)&#x000A;}&#x000A;// Set the reporting period to be once per second.&#x000A;view.SetReportingPeriod(1 * time.Second)&#x000A;// [[End: Add this block]]&#x000A;&#x000A;// Here’s our fake video processing application. Every second, it&#x000A;// checks the length of the input queue (e.g., number of videos&#x000A;// waiting to be processed) and records that information.&#x000A;for {&#x000A;time.Sleep(1 * time.Second)&#x000A;queueSize := getQueueSize()&#x000A;&#x000A;// Record the queue size.&#x000A;stats.Record(ctx, videoServiceInputQueueSize.M(queueSize))&#x000A;fmt.Println("Queue size: ", queueSize)&#x000A;}&#x000A;}&#x000A;&#x000A;func getQueueSize() (int64) {&#x000A;// Fake out a queue size here by returning a random number between&#x000A;// 1 and 100.&#x000A;return rand.Int63n(100) + 1&#x000A;}&#x000A;&#x000A;</code></pre>
<p>Above, <code>view.View{...}</code> defines the name of the exported metric (using the same name as the name for the measure itself), associates it with the <code>videoServiceInputQueueSize</code> measure, and specifies, via the <code>Aggregation</code> field, to export the last value of that metric. We also explicitly set the reporting period. For this example, the metric is specified to be reported every second; the best practices for a production service is to report metrics no more frequently than once per minute.</p>
<p>See  <a href="https://godoc.org/go.opencensus.io/stats/view" target="_blank">https://godoc.org/go.opencensus.io/stats/view</a> for full details about setting up views for metrics collection and aggregation.</p>
<h2 id="step10">Reporting default metrics to Cloud Monitoring</h2>
<p>The final step is to export the application metric to Cloud Monitoring. This is done by configuring the OpenCensus Cloud Monitoring exporter.</p>
<p>Add the changes identified by <code>// [[Add this line]]</code> or <code>// [[Add this block]] … // [[End: add this block]]</code> to your file, then uncomment the added lines and remove the instructions:</p>
<pre><code class="language-bash prettyprint">package main&#x000A;&#x000A;import (&#x000A;"context"&#x000A;"fmt"&#x000A;"log"&#x000A;"math/rand"&#x000A;"os"        // [[Add]]&#x000A;"time"&#x000A;&#x000A;"contrib.go.opencensus.io/exporter/stackdriver"   // [[Add]]&#x000A;"go.opencensus.io/stats"&#x000A;"go.opencensus.io/stats/view"&#x000A;&#x000A;monitoredrespb "google.golang.org/genproto/googleapis/api/monitoredres" // [[Add]]&#x000A;)&#x000A;&#x000A;var videoServiceInputQueueSize = stats.Int64(&#x000A;"my.videoservice.org/measure/input_queue_size",&#x000A;"Number of videos queued up in the input queue",&#x000A;stats.UnitDimensionless)&#x000A;&#x000A;func main() {&#x000A;// [[Add block]]&#x000A;// Setup metrics exporting to Stackdriver.&#x000A;exporter, err := stackdriver.NewExporter(stackdriver.Options{&#x000A;ProjectID: os.Getenv("MY_PROJECT_ID"),&#x000A;Resource: &amp;monitoredrespb.MonitoredResource {&#x000A;Type: "gce_instance",&#x000A;Labels: map[string]string {&#x000A;"instance_id": os.Getenv("MY_GCE_INSTANCE_ID"),&#x000A;"zone": os.Getenv("MY_GCE_INSTANCE_ZONE"),&#x000A;},&#x000A;},&#x000A;})&#x000A;if err != nil {&#x000A;log.Fatalf("Cannot setup Stackdriver exporter: %v", err)&#x000A;}&#x000A;view.RegisterExporter(exporter)&#x000A;// [[End: add block]]&#x000A;&#x000A;ctx := context.Background()&#x000A;&#x000A;// Setup a view so that we can export our metric.&#x000A;if err := view.Register(&amp;view.View{&#x000A;Name: "my.videoservice.org/measure/input_queue_size",&#x000A;Description: "Number of videos queued up in the input queue",&#x000A;Measure: videoServiceInputQueueSize,&#x000A;Aggregation: view.LastValue(),&#x000A;}); err != nil {&#x000A;log.Fatalf("Cannot setup view: %v", err)&#x000A;}&#x000A;// Set the reporting period to be once per second.&#x000A;view.SetReportingPeriod(1 * time.Second)&#x000A;&#x000A;// Here’s our fake video processing application. Every second, it&#x000A;// checks the length of the input queue (e.g., number of videos&#x000A;// waiting to be processed) and records that information.&#x000A;for {&#x000A;time.Sleep(1 * time.Second)&#x000A;queueSize := getQueueSize()&#x000A;&#x000A;// Record the queue size.&#x000A;stats.Record(ctx, videoServiceInputQueueSize.M(queueSize))&#x000A;fmt.Println("Queue size: ", queueSize)&#x000A;}&#x000A;}&#x000A;&#x000A;func getQueueSize() (int64) {&#x000A;// Fake out a queue size here by returning a random number between&#x000A;// 1 and 100.&#x000A;return rand.Int63n(100) + 1&#x000A;}&#x000A;</code></pre>
<p>The OpenCensus metrics exporter for Cloud Monitoring is a contributed package. For the exporter to function correctly, the <code>ProjectID</code> is provided to it. This lab is using the value set by the <code>MY_PROJECT_ID</code> environment variable.</p>
<p>In addition, Cloud Monitoring requires that metrics be reported against a monitored resource. A monitored resource identifies the source of the metric data. For this lab the metrics are reported against the underlying Compute Engine VM instance. This is done by specifying the <code>Resource</code> parameter in <code>stackdriver.Options</code>:</p>
<p><img alt="d66b7eb43806df69.png" src="https://cdn.qwiklabs.com/K6BxU3w%2BWRI13WTZfVHrEL6CyXVClnGKFC7im%2BUB43I%3D"></p>
<p>The type <code>gce_instance</code> specifies the type of monitored resource to associate with the metric. Compute Engine VM instances have two labels, an "<code>instance_id</code>" and a "<code>zone</code>". The <code>instance_id</code> is the numeric id of the Compute Engine VM instance and the <code>zone</code> is the zone in which the instance is running. You can find this information on Compute Engine's detail page for your instance. The zone information is readily available. To determine the instance ID for your Compute Engine VM instance, click Equivalent REST at the bottom of the page; the ID is a 19-digit number. For convenience, these values are set in environment variables rather than hard-coding them in the Go application.</p>
<p>Now you need to somehow route the metrics you care about to the exporter. This is achieved by registering the exporter with the view that is collecting and aggregating the metrics - i.e., via <code>view.Register(...)</code>.</p>
<p>See  <a href="https://godoc.org/contrib.go.opencensus.io/exporter/stackdriver" target="_blank">https://godoc.org/contrib.go.opencensus.io/exporter/stackdriver</a> for more details about the OpenCensus exporter for Cloud Monitoring.</p>
<p>Save and close the <code>main.go</code> file by pressing <strong>Ctrl + x</strong> and then <strong>Y</strong>.</p>
<h2 id="step11">View your application metrics in Cloud Monitoring</h2>
<p>You're just about ready to view your application metrics in Cloud Monitoring.</p>
<p>In the SSH window, set the necessary environment variables:</p>
<ul>
<li>
<p>Project ID - found on the page where you started this lab.</p>
</li>
</ul>
<pre><code class="language-bash prettyprint">export MY_PROJECT_ID=&lt;your-project-id&gt;&#x000A;export MY_GCE_INSTANCE_ID=my-opencensus-demo&#x000A;export MY_GCE_INSTANCE_ZONE=us-central1-a&#x000A;</code></pre>
<pre><code class="language-bash prettyprint">go mod tidy&#x000A;</code></pre>
<p>Now run your application:</p>
<pre><code class="language-bash prettyprint">go run main.go&#x000A;</code></pre>
<ql-infobox><strong>Note:</strong> If you see errors, you can ignore them.
</ql-infobox>
<p>You can leave the application running.</p>
<p>Go back to the Cloud Console, you should be on the Cloud Monitoring window.</p>
<p>In the left menu, click <strong>Metrics Explorer</strong>.</p>
<p>In the <strong>Find resource type and metric</strong> text box, select <strong>VM Instance</strong> under <strong>Resource types</strong>, then type ‘<code>input</code>' in the <strong>Select a metric</strong> row, and press <strong>Enter</strong>.</p>
<p><img alt="766f9a5d4308e3d1.png" src="https://cdn.qwiklabs.com/VcU9oQ0Kk56aW%2FmyoIgX2tvHtRVEht8R0%2FKm%2FX34GFo%3D"></p>
<ql-infobox><strong>Note:</strong> If you don't see the "OpenCensus/my.videoservice.org" choice, give Cloud Monitoring a few minutes to collect data, refresh your browser, and try again.
</ql-infobox>
<p>You should soon see data in the graph, maybe something like this:</p>
<p><img alt="d32993f0168744d4.png" src="https://cdn.qwiklabs.com/pMzvjLAf4tofJg5uZpdv6IRYOpbFWysLhRh3%2BJJ4JAo%3D"></p>
<p>Click <strong>Check my progress</strong> to verify your performed task.</p>
<ql-activity-tracking step="3">
    View your application metrics in Cloud Monitoring
</ql-activity-tracking>
<h2 id="step12">Other methods for reporting application metrics to Cloud Monitoring</h2>
<p>Users who are instrumenting their code for the first time should use the  <a href="https://opencensus.io/" target="_blank">OpenCensus library</a>, as shown in this lab. Users with pre-existing instrumentation should consider one of the existing adapters:</p>
<ul>
<li>Prometheus: Use the  <a href="https://cloud.google.com/monitoring/kubernetes-engine/prometheus" target="_blank">Prometheus integration</a> (beta).</li>
<li>
<a href="https://github.com/etsy/statsd/wiki" target="_blank">StatsD</a> and anything else supported by  <a href="https://collectd.org/" target="_blank">collectd</a>: Use the Cloud Monitoring agent. See the  <a href="https://cloud.google.com/monitoring/agent/custom-metrics-agent" target="_blank">Custom Metrics from the Agent</a> documentation to get this setup. The documentation on  <a href="https://cloud.google.com/monitoring/custom-metrics/" target="_blank">Custom Metrics</a> might also be valuable.</li>
</ul>
<p>While Cloud Monitoring offers a public API, the  <a href="https://cloud.google.com/monitoring/api/ref_v3/rest/v3/projects.timeSeries/create" target="_blank">CreateTimeSeries API</a>, for metrics ingestion, is mainly for ingestion use cases not covered by OpenCensus, such as bulk ingestion. Use of any other approach not outlined above is currently unsupported.</p>
<h2 id="step13">Congratulations!</h2>
<p>You have successfully written a simple application that uses OpenCensus to export metrics to Cloud Monitoring.</p>
<p><img alt="4588136b652766c0.png" src="https://cdn.qwiklabs.com/v9Q2F9GfjA%2Ff5nwcDjkXPkJaN1L51MLqa%2BhmudOLIaM%3D"></p>
<h3>Finish Your Quest</h3>
<p>This self-paced lab is part of the Qwiklabs <a href="https://google.qwiklabs.com/quests/35" target="_blank">Google Cloud's Operations Suite</a> Quest. A Quest is a series of related labs that form a learning path.  Completing this Quest earns you the badge above, to recognize your achievement. You can make your badge public and link to them in your online resume or social media account. <a href="https://google.qwiklabs.com/learning_paths/35/enroll" target="_blank">Enroll in this Quest</a> and get immediate completion credit if you've taken this lab.  <a href="https://google.qwiklabs.com/catalog" target="_blank">See other available Qwiklabs Quests</a>.</p>
<h3>Take your Next Lab</h3>
<p>Continue your Quest with <a href="https://google.qwiklabs.com/catalog_lab/755" target="_blank">Monitoring Multiple Projects with Cloud Monitoring</a>, or check out these suggestions:Learn more about Cloud Monitoring in our other labs:</p>
<ul>
<li>
<p><a href="https://google.qwiklabs.com/catalog_lab/1110" target="_blank">Monitoring and Logging for Cloud Functions</a></p>
</li>
<li>
<p><a href="https://google.qwiklabs.com/catalog_lab/756" target="_blank">Autoscaling an Instance Group with Custom Cloud Monitoring Metrics</a></p>
</li>
</ul>
<h3>Next Steps / Learn More</h3>
<p>Here are links to the  <a href="https://cloud.google.com/stackdriver/docs/" target="_blank">full Cloud Monitoring documentation</a>, with details for each product:</p>
<ul>
<li>Cloud Logging:  <a href="https://cloud.google.com/logging/docs/" target="_blank">https://cloud.google.com/logging/docs/</a>
</li>
<li>Cloud Monitoring:  <a href="https://cloud.google.com/monitoring/docs/" target="_blank">https://cloud.google.com/monitoring/docs/</a>
</li>
<li>Cloud Trace:  <a href="https://cloud.google.com/trace/docs/" target="_blank">https://cloud.google.com/trace/docs/</a>
</li>
<li>Cloud Error Reporting:  <a href="https://cloud.google.com/error-reporting/docs/" target="_blank">https://cloud.google.com/error-reporting/docs/</a>
</li>
<li>Cloud Debugger:  <a href="https://cloud.google.com/debugger/docs/" target="_blank">https://cloud.google.com/debugger/docs</a>
</li>
<li>See  <a href="https://godoc.org/go.opencensus.io/stats" target="_blank">https://godoc.org/go.opencensus.io/stats</a> for more details.</li>
</ul>
<h3>Google Cloud Training &amp; Certification</h3>
<p>...helps you make the most of Google Cloud technologies. <a href="https://cloud.google.com/training/courses" target="_blank">Our classes</a> include technical skills and best practices to help you get up to speed quickly and continue your learning journey. We offer fundamental to advanced level training, with on-demand, live, and virtual options to suit your busy schedule. <a href="https://cloud.google.com/certification/" target="_blank">Certifications</a> help you validate and prove your skill and expertise in Google Cloud technologies.</p>

<h5>Manual Last Updated May 17, 2021</h5>
<h5>Lab Last Tested May 17, 2021</h5>
<p>Copyright 2021 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>



</div>
</div>


<div class='hidden js-end-lab-button-container lab-content__end-lab-button'>
<ql-lab-control-button class='js-end-lab-button' running></ql-lab-control-button>
</div>
<!-- / TODO: Move recommendations into the end lab modal -->
<div class='lab-content__renderable-instructions'>
<div class='lab-content__recommendation'>
<!-- # TODO: Change classes so that this doesn't stack vertically -->
<section class='upcoming-cards'>
<h2 class='ql-headline-4'>Continue questing</h2>
<div class='content-card-grid'>
<div class='card-content-wrapper js-content-card' data-id='1047' data-level='Fundamental' data-name='Reporting Application Metrics into Cloud Monitoring' data-type='Lab'>
<a class="card card--content elevation-0 content-lab" href="/focuses/1259?parent=catalog"><div class='card__image'>
<div class='card__image__inner' style='background-image: url(https://cdn.qwiklabs.com/assets/fractal4-1d205807c54d90fe4382315dbfc0dd665ddb825bbc90f3ca5db7d7170fa0df1b.jpg)'></div>
</div>
<div class='card__body'>
<div class='overline card--content__type'>
Lab
</div>
<h3 class='card--content__title'>
Reporting Application Metrics into Cloud Monitoring
</h3>
<div class='card--content__description body-1'>
<p>
In this lab you will run an application on Compute Engine instance and report the application’s metrics into Cloud Monitoring using the OpenCensus library.
</p>
</div>
</div>
<div class='card__footer'>
<div class='card__footer__left'>
<span>Fundamental</span>
</div>
<div class='card__footer__right'>
<div class='rateit' data-rateit-readonly='true' data-rateit-value='3.9653'></div>
</div>
</div>
</a></div>

</div>
</section>

</div>

</div>
</ql-drawer-content>
<ql-drawer end id='outline-drawer' open slot='drawer' width='320'>
<div class='js-lab-content-outline lab-content__outline'>
<a href='#step1'>GSP111</a><a href='#step2'>Overview</a><a href='#step3'>What is OpenCensus?</a><a href='#step4'>Setup and requirements</a><a href='#step5'>Create a Compute Engine instance</a><a href='#step6'>Install Go and OpenCensus on your instance</a><a href='#step7'>Create a basic application server in Go</a><a href='#step8'>Defining & recording measures using OpenCensus</a><a href='#step9'>Setting up metrics collection & aggregation</a><a href='#step10'>Reporting default metrics to Cloud Monitoring</a><a href='#step11'>View your application metrics in Cloud Monitoring</a><a href='#step12'>Other methods for reporting application metrics to Cloud Monitoring</a><a href='#step13'>Congratulations!</a>
</div>
</ql-drawer>
</ql-drawer-container>
</ql-drawer-content>
</ql-drawer-container>
<div class='lab-introduction js-lab-introduction is-hidden'>
<div class='lab-introduction__inner'>
<h1 class='headline-1'>Welcome to Your First Lab!</h1>
<ql-icon-button class='js-skip-button'>close</ql-icon-button>
<div class='lab-introduction__video'>
<iframe allow='autoplay; encrypted-media' allowfullscreen frameborder='0' id='lab-introduction' src='https://www.youtube.com/embed/yF7EDXKTmoQ?enablejsapi=1&amp;rel=0&amp;showinfo=0'></iframe>
</div>
<a class='js-skip-button button button--outline'>Skip this video</a>
</div>
</div>



</div>
</main>


<div class='modal fade' id='lab-details-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<div class='modal-body'>
<p class='l-mbm'>
In this lab you will run an application on Compute Engine instance and report the application’s metrics into Cloud Monitoring using the OpenCensus library.
</p>
<p>
This lab is included in these quests:
<a href="/quests/35">Google Cloud&#39;s Operations Suite</a>, <a href="/quests/143">Monitor and Log with Google Cloud Operations Suite</a>.
If you complete this lab you&#39;ll receive credit for it when you enroll in one of these quests.
</p>
<p class='small-label l-mbs'>
<strong>
Duration:
</strong>
0m setup
&middot;
90m access
&middot;
60m completion
</p>
<p class='small-label l-mbs'>
<span><strong>Levels: </strong>fundamental</span>
</p>
<p class='small-label'>
<strong>
Permalink:
</strong>
<a href="https://www.qwiklabs.com/catalog_lab/1047">https://www.qwiklabs.com/catalog_lab/1047</a>
</p>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Got It
</a>
</div>


</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='modal fade' id='lab-review-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<form class="simple_form js-lab-review-form" id="new_lab_review" action="/lab_reviews" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='modal-body'>
<p class='label'>
How satisfied are you with this lab?*
</p>
<div class='rateit js-rateit' data-rateit-max='5' data-rateit-min='0' data-rateit-resetable='false' data-rateit-step='1' data-rateit-value='0'></div>
<div class='l-mtm'>

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="3894861" name="lab_review[user_id]" id="lab_review_user_id" /></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[classroom_id]" id="lab_review_classroom_id" /></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="1047" name="lab_review[lab_id]" id="lab_review_lab_id" /></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[focus_id]" id="lab_review_focus_id" /></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" name="lab_review[rating]" id="lab_review_rating" /></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Comment</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment">
</textarea></div></div>
</div>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Cancel
</a>
<input type="submit" name="commit" value="Submit" disabled="disabled" id="submit" data-disabled="false" class="button" data-disable-with="Submit" />
</div>
</form>

</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='modal fade' id='lab-access-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<a class='lab-access-modal-close' data-analytics-action='dismissed_lab_payment_modal' data-dismiss='modal'>
<i class='material-icons'>close</i>
</a>
<form class="js-lab-access-form" action="/lab_onetime_coupons/activate?parent=catalog" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />
<div class='modal-body'>
<div class='lab-access-modal'>
<input type="hidden" name="id" id="id" value="1259" />
<input type="hidden" name="user_id" id="user_id" value="3894861" />
<input type="hidden" name="launch_with_credits" id="launch_with_credits" value="0" class="js-launch-with-credits-input" />
<input type="hidden" name="launch_with_subs" id="launch_with_subs" value="0" class="js-launch-with-subscription-input" />
<input type="hidden" name="launch_with_access_code" id="launch_with_access_code" value="0" class="js-launch-with-access-code" />
<div class='lab-access-modal__method'>
<p>
This lab costs
5 Credits.
</p>
<p>
1945 Credits
available
</p>
<a class='button js-launch-with-credits-button js-lab-access-modal-button' data-analytics-action='clicked_launch_with_credits_button'>
Launch with
5 Credits
</a>
</div>
<div class='lab-access-modal__method'>
<p>
Enter Lab Access Code:
</p>
<div class='lab-access-modal__code js-access-code'>
<input type="text" name="uuid_1" id="uuid_1" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
<input type="text" name="uuid_2" id="uuid_2" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
<input type="text" name="uuid_3" id="uuid_3" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
<input type="text" name="uuid_4" id="uuid_4" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
</div>
<a class='button js-launch-with-access-code-button js-lab-access-modal-button' data-analytics-action='clicked_launch_with_access_code_button'>
Launch with Access Code
</a>
</div>
</div>
</div>
</form>



</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>


<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    ql.favoriting.init();
  ql.labControlPanel.addRecaptchaErrorHandler();
  initLabContent();
  ql.labOutline.links.init();
  initLabReviewModal();
  initLabAccessModal();
  ql.labAssessment.init();
  ql.labIntroduction.init( true );
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?\n","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.\n","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>

</body>
</html>

