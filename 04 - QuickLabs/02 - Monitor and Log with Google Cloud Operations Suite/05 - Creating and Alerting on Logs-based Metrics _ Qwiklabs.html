
<!DOCTYPE html>
<html lang='en'>
<head>
<title>Creating and Alerting on Logs-based Metrics | Qwiklabs</title>
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"DANIEL","lastname":"ENRIQUE SANDOVAL SANCHEZ","fullname":"DANIEL ENRIQUE SANDOVAL SANCHEZ","company":"Coursera","email":"desandovals@liverpool.com.mx","origin":"googlecoursera-run, lti-coursera","subscriptions":0,"id":"40414ff5fc280f833d9acca966912f93","qlCreatedAt":"2020-11-17 20:45:59 UTC","optIn":null,"current_organization_id":null,"current_organization_role":null};gon.segment="j4Im8pqIko0Lxq4wVVZWMPMM0EroHUvb";gon.deployment="run";gon.content={"type":"Lab","id":753,"name":"Creating and Alerting on Logs-based Metrics"};
//]]>
</script>
<script>
  dataLayer = [
    {user: gon.current_user},
    {content: gon.content}
  ];
</script>
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-TQR88QK");
</script>
<script>
  EVENT_SOURCE_BASE_URL = "https://run.qwiklabs.com/nchan-sub?id=";
</script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/polyfills/webcomponents-loader-408088dc333247a761de5f2b2a4ba1cabd2bc36579f83ba92a559eb3682a9b77.js"></script>
<script src="https://cdn.qwiklabs.com/assets/vendor-45d462772c30000424907184f70c7157e95fb6227698d1671c5051818a6f60d8.js"></script>
<script src="https://cdn.qwiklabs.com/assets/application-034d6698d9e8e4069d310e418a7827442046e71025a0e336e0896055be8a1153.js"></script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/hallofmirrors-b1177b2da0d0a4d1b239b0364e70f5a598873a2b8fb44c288c9428709123506c.js"></script>
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script type='application/ld+json'>
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>


<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="8icRqyoiDyolHeKiv3D6RQRDedriA5YEsDF6zIu6pWZiqQaaCskZd8fVja0dGyTWhyDI3JmhSA2o1GUkihb1Ug==" />
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0' name='viewport'>
<meta content='1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0' name='google-site-verification'>
<meta content='#3681E4' property='msapplication-TileColor'>
<meta content='/favicon-144.png' property='msapplication-TileImage'>
<meta content='[{&quot;id&quot;:&quot;recaptcha_experiment&quot;,&quot;optimize_id&quot;:&quot;dpViOcLkT3qS4TvL2mRojA&quot;,&quot;title&quot;:&quot;No Recaptcha shown for trusted users&quot;,&quot;variant_index&quot;:0,&quot;variant&quot;:&quot;original&quot;}]' name='active-experiments'>
<meta content='{&quot;userId&quot;:3894861}' name='help-api-product-data'>
<meta content='In this hands-on lab we take a look through some of the information provided by the Cloud Monitoring tools, and teach some of the concepts you will need to know to take advantage of Cloud Monitoring effectively.' name='description'>
<meta content='Qwiklabs' name='author'>
<meta content='Creating and Alerting on Logs-based Metrics | Qwiklabs' property='og:title'>
<meta content='website' property='og:type'>
<meta content='/favicon-144.png' property='og:image'>
<meta content='Qwiklabs' property='og:site_name'>
<meta content='In this hands-on lab we take a look through some of the information provided by the Cloud Monitoring tools, and teach some of the concepts you will need to know to take advantage of Cloud Monitoring effectively.' property='og:description'>
<meta content='/qwiklabs_logo_900x887.png' property='og:logo' size='900x887'>
<meta content='/qwiklabs_logo_994x187.png' property='og:logo' size='994x187'>


<link href='/favicon-32.png' rel='shortcut icon'>
<link color='#3681E4' href='/favicon-svg.svg' rel='mask-icon'>
<link href='/favicon-180.png' rel='apple-touch-icon-precomposed'>



<link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Oswald:400|Roboto+Mono:400,700|Roboto:300,400,500,700|Google+Sans:300,400,500,700|Google+Sans+Display:400|Material+Icons|Google+Material+Icons" />


<link rel="stylesheet" media="all" href="https://cdn.qwiklabs.com/assets/application-3b0f6c441394eebd52ff10f04fb2923fdb7b1b4fec780e7fa8ef67f5dd2ef411.css" />



</head>
<body class='lab-show l-full no-nav application-new focuses focuses-show lab-show l-full no-nav '>
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-TQR88QK' style='display:none;visibility:hidden;' width='0'></iframe>
</noscript>
<span class='hidden' id='flash-sibling-before'></span>

<div class='header-container light-theme'>
<div class='header'>
<ql-icon-button class='js-nav-toggle header__nav-panel-button l-mrm'>menu</ql-icon-button>
<div class='header__title'>
<ql-icon-button label="Back" href="https://www.qwiklabs.com/quests/143" id="f2b1bfb79b5e54f4" target="_self">arrow_back</ql-icon-button><div class="mdl-tooltip" data-mdl-for="f2b1bfb79b5e54f4">Back</div>

<h1 class='headline-5'>
Creating and Alerting on Logs-based Metrics
</h1>
</div>
<div class='header__actions'>
<ql-icon-button class='header__button--search js-header-search-bar-button'>search</ql-icon-button>
<ql-icon-button id='share_753'>share</ql-icon-button>
<ql-menu for='share_753'>
<ql-menu-item>
<a data-analytics-action="Shared to LinkedIn." data-analytics-category="Lab" data-analytics-label="Creating and Alerting on Logs-based Metrics" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.qwiklabs.com%2Fcatalog_lab%2F753%3Futm_medium%3Dsocial%26utm_source%3Dlinkedin%26utm_campaign%3Dql-social-share"><ql-icon class='l-mrs'>post_linkedin</ql-icon>
LinkedIn
</a>
</ql-menu-item>
<ql-menu-item>
<a data-analytics-action="Shared to Twitter." data-analytics-category="Lab" data-analytics-label="Creating and Alerting on Logs-based Metrics" target="_blank" href="https://twitter.com/intent/tweet?text=Learn%20cloud%20tech%20through%20hands-on%20training%20on%20%23Qwiklabs%21&amp;url=https%3A%2F%2Fwww.qwiklabs.com%2Fcatalog_lab%2F753%3Futm_medium%3Dsocial%26utm_source%3Dtwitter%26utm_campaign%3Dql-social-share&amp;hashtags="><ql-icon class='l-mrs'>post_twitter</ql-icon>
Twitter
</a>
</ql-menu-item>
<ql-menu-item>
<a data-analytics-action="Shared to Facebook." data-analytics-category="Lab" data-analytics-label="Creating and Alerting on Logs-based Metrics" target="_blank" href="https://facebook.com/sharer.php?display=popup&amp;u=https%3A%2F%2Fwww.qwiklabs.com%2Fcatalog_lab%2F753%3Futm_medium%3Dsocial%26utm_source%3Dfacebook%26utm_campaign%3Dql-social-share"><ql-icon class='l-mrs'>post_facebook</ql-icon>
Facebook
</a>
</ql-menu-item>
<ql-menu-item>
<ql-copyable-input label='Share Link' value='https://www.qwiklabs.com/catalog_lab/753'></ql-copyable-input>
</ql-menu-item>
</ql-menu>

<a class="icon-button js-favorite-button favorite-button" id="CatalogItem-619-favorite-button" data-type="CatalogItem" data-id="619" data-name="Creating and Alerting on Logs-based Metrics" href="/favorite.json?item_id=619&amp;item_type=CatalogItem"><ql-icon>favorite_border</ql-icon>
</a><div class='mdl-tooltip js-tooltip' for='CatalogItem-619-favorite-button'>
Add to favorites
</div>



<ql-icon-button id='control-panel-target' style='display: none;'>
dashboard
</ql-icon-button>
<ql-menu for='control-panel-target' id='control-panel-menu'></ql-menu>

<ql-icon-button id='help-menu-button'>help</ql-icon-button>
<div class='mdl-tooltip js-tooltip' data-mdl-for='help-menu-button'>
Help
</div>
<ql-menu for='help-menu-button' id='help-menu'>
<ql-menu-item>
<ql-help context='lab' data-analytics-action='opened_help' data-analytics-label='lab' productdata='{&quot;userId&quot;:3894861}'>
Help Center
</ql-help>
</ql-menu-item>
<ql-menu-item>
<a target="_blank" class="ql-body-1" href="https://support.google.com/qwiklabs/contact/contact_us">Email support</a>
</ql-menu-item>
</ql-menu>

<ql-icon-button id='language'>language</ql-icon-button>
<div class='mdl-menu mdl-menu__bottom-right mdl-js-menu elevation-3' for='language'>
<a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ar" href="/focuses/619?locale=ar&amp;parent=catalog">العربية‬‎
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="de" href="/focuses/619?locale=de&amp;parent=catalog">Deutsch
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="en" href="/focuses/619?locale=en&amp;parent=catalog">English
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="es" href="/focuses/619?locale=es&amp;parent=catalog">español (Latinoamérica)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="fr" href="/focuses/619?locale=fr&amp;parent=catalog">français
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="id" href="/focuses/619?locale=id&amp;parent=catalog">bahasa Indonesia
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="it" href="/focuses/619?locale=it&amp;parent=catalog">Italiano
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ja" href="/focuses/619?locale=ja&amp;parent=catalog">日本語
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ko" href="/focuses/619?locale=ko&amp;parent=catalog">한국어
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pl" href="/focuses/619?locale=pl&amp;parent=catalog">Polski
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_BR" href="/focuses/619?locale=pt_BR&amp;parent=catalog">português (Brasil)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_PT" href="/focuses/619?locale=pt_PT&amp;parent=catalog">português (Portugal)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ru" href="/focuses/619?locale=ru&amp;parent=catalog">русский
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="tr" href="/focuses/619?locale=tr&amp;parent=catalog">Türkçe
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh" href="/focuses/619?locale=zh&amp;parent=catalog">简体中文
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh_TW" href="/focuses/619?locale=zh_TW&amp;parent=catalog">繁體中文
</a></div>
<button class='icon-button' id='my_account'>
<ql-avatar src='https://lh3.googleusercontent.com/a-/AOh14Gh6Bmcr7vfcCi5iPAH2qDeJgSaD6RLv1Muiv9mceA=s320-c'></ql-avatar>
</button>
<ql-menu for='my_account' open>
<div class='my-account-menu'>
<ql-avatar class='l-mtl l-mbl' size='120' src='https://lh3.googleusercontent.com/a-/AOh14Gh6Bmcr7vfcCi5iPAH2qDeJgSaD6RLv1Muiv9mceA=s320-c'></ql-avatar>
<div class='my-account-menu__user-info l-mbl'>
<h4 class='ql-subhead-1'>DANIEL ENRIQUE SANDOVAL SANCHEZ</h4>
<p class='ql-body-2 text--light'>desandovals@liverpool.com.mx</p>
<p class='ql-body-2 text--light'>
</p>
<a class="text--green ql-subhead-2" href="/my_account/payments"><ql-chip positive>
1940 Credits
</ql-chip>
</a></div>
<div class='buttons l-mbl'>
<a class="button button--hairline" id="settings" href="/my_account/profile">Settings</a>
</div>
<hr>
<ql-button data-analytics-action='clicked_sign_out' href='/users/sign_out' method='delete'>
Sign Out
</ql-button>
<div class='privacy l-mtl'>
<a class="ql-caption text--light" href="/privacy_policy">Privacy</a>
<span class='ql-caption text--light l-mls l-mrs'>&middot;</span>
<a class="ql-caption text--light" href="/terms_of_service">Terms</a>
</div>
</div>
</ql-menu>

</div>
</div>
<div class='header__search-bar js-header-search-bar'>
<form class="js-search-form-mobile" onsubmit="ql.searchFilter(); return false;" action="/searches/elasticsearch" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="SmyRbk1nFCC9tgLwstIQGwslnlJCNBPt2fTH9CQQZiDa4oZfbYwCfV9+bf8Quc6IiEYvVDmWzeTBEdgcJbw2FA==" />
<input type="text" name="keywords" id="keywords" placeholder="Search" maxlength="255" aria-label="catalog search bar" />
</form>

<ql-icon-button class='js-close-search-bar'>close</ql-icon-button>
</div>
</div>

<nav class='nav-bar'>
<a class="nav-bar__item js-navigation-button" href="/"><ql-icon class='nav-bar__item__icon'>
home
</ql-icon>
<span class='nav-bar__item__label'>
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button  active" aria-current="page" href="/catalog"><ql-icon class='nav-bar__item__icon'>
school
</ql-icon>
<span class='nav-bar__item__label'>
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="/my_learning"><ql-icon class='nav-bar__item__icon'>
event_note
</ql-icon>
<span class='nav-bar__item__label'>
My Learning
</span>
</a>
</nav>

<nav class='nav-panel js-nav-panel'>
<div class='nav-panel__logo'>
<div class='logo logo--blue'></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="/"><ql-icon class='nav-panel__item__icon'>
home
</ql-icon>
<div class='nav-panel__item__label'>
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button active" aria-current="page" href="/catalog"><ql-icon class='nav-panel__item__icon'>
school
</ql-icon>
<div class='nav-panel__item__label'>
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_learning"><ql-icon class='nav-panel__item__icon'>
event_note
</ql-icon>
<div class='nav-panel__item__label'>
My Learning
</div>
</a>
<div class='nav-panel__spacer'></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/profile"><ql-icon class='nav-panel__item__icon'>
account_circle
</ql-icon>
<div class='nav-panel__item__label'>
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/credits"><ql-icon class='nav-panel__item__icon'>
money
</ql-icon>
<div class='nav-panel__item__label'>
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/security"><ql-icon class='nav-panel__item__icon'>
security
</ql-icon>
<div class='nav-panel__item__label'>
Security
</div>
</a>
<div class='nav-panel__spacer'></div>
<a class="nav-panel__item" tabindex="-1" href="#"><ql-help>
<div class='nav-panel__help-item'>
<ql-icon class='nav-panel__item__icon'>help</ql-icon>
<div class='nav-panel__item__label'>
Help
</div>
</div>
</ql-help>
</a><div class='nav-panel__small-links'>
<a tabindex="-1" href="/privacy_policy">Privacy</a>
<a tabindex="-1" href="/terms_of_service">Terms</a>
</div>
</nav>
<div class='nav-panel__overlay js-nav-toggle'></div>

<main class='js-main'>
<div class='l-main-wrapper' id='main-wrapper'>







<div class='lab-assessment__tab js-open-lab-assessment-panel'>
<h6 class='js-lab-assessment-total-score'>
&mdash;/100
</h6>
</div>
<div class='lab-assessment__panel js-lab-assessment-panel'>
<div class='lab-assessment__panel__header'>
<h4>Checkpoints</h4>
<ql-icon-button class='js-close-lab-assessment-panel'>arrow_forward</ql-icon-button>
</div>
<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Deploy a Guestbook app to App Engine and Indexes for datastore
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='1'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-1'>
</span>
/ 10
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create a Monitoring workspace
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='2'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-2'>
</span>
/ 10
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create an uptime check
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='3'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-3'>
</span>
/ 15
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create user defined logs-based metrics
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='4'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-4'>
</span>
/ 30
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create labels and user defined metrics
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='5'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-5'>
</span>
/ 20
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Create the Foodcount alerting policy
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='6'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-6'>
</span>
/ 15
</p>
</div>
</div>

</div>
<ql-drawer-container class='js-lab-state' data-analytics-payload='{&quot;label&quot;:&quot;Creating and Alerting on Logs-based Metrics&quot;,&quot;lab_name&quot;:&quot;Creating and Alerting on Logs-based Metrics&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;run&quot;}' data-focus-id='619' data-lab-billing-limit='0.0' data-lab-duration='5400' data-parent='catalog' data-payment-required data-recaptcha-enabled id='lab-container'>
<ql-drawer id='terminal-drawer' slot='drawer' style='width: calc(100% - 480px)'>
<iframe allow='clipboard-read' class='terminal' id='embedded-resource'></iframe>
</ql-drawer>
<ql-drawer-content class='js-lab-wrapper' id='lab-content' slot='drawer-content'>
<ql-drawer-container id='lab-content-container'>
<ql-drawer id='control-panel-drawer' open slot='drawer' width='320'>
<ql-lab-control-panel class='ql-lab-control-panel__max-height control-panel js-lab-control-panel' connectionFiles='[]' labControlButton='{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}' labDetails='[]' labTimer='{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:5400}' studentResources='[{&quot;text&quot;:&quot;Create an Alert on an Audit Log&quot;,&quot;icon&quot;:&quot;videocam&quot;,&quot;href&quot;:&quot;https://youtu.be/LdGqmnoowc8&quot;}]'>
<script src="https://www.recaptcha.net/recaptcha/api.js?render=6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr"   ></script>
        <script>
          // Define function so that we can call it again later if we need to reset it
          // This executes reCAPTCHA and then calls our callback.
          function executeRecaptchaForStartLab() {
            grecaptcha.ready(function() {
              grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}).then(function(token) {
                setInputWithRecaptchaResponseTokenForStartLab('g-recaptcha-response-data-start-lab', token)
              });
            });
          };
          // Invoke immediately
          executeRecaptchaForStartLab()

          // Async variant so you can await this function from another async function (no need for
          // an explicit callback function then!)
          // Returns a Promise that resolves with the response token.
          async function executeRecaptchaForStartLabAsync() {
            return new Promise((resolve, reject) => {
              grecaptcha.ready(async function() {
                resolve(await grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}))
              });
            })
          };

                    var setInputWithRecaptchaResponseTokenForStartLab = function(id, token) {
            var element = document.getElementById(id);
            element.value = token;
          }

        </script>
<input type="hidden" name="g-recaptcha-response-data[start_lab]" id="g-recaptcha-response-data-start-lab" data-sitekey="6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr" class="g-recaptcha g-recaptcha-response "/>

<div class='hidden' id='recaptcha-v2-start-lab' slot='recaptcha'>
<script src="https://www.recaptcha.net/recaptcha/api.js" async defer ></script>
<div data-sitekey="6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV" data-callback="recaptchaComplete" data-expired-callback="expireV2Token" class="g-recaptcha "></div>
          <noscript>
            <div>
              <div style="width: 302px; height: 422px; position: relative;">
                <div style="width: 302px; height: 422px; position: absolute;">
                  <iframe
                    src="https://www.recaptcha.net/recaptcha/api/fallback?k=6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV"
                    name="ReCAPTCHA"
                    style="width: 302px; height: 422px; border-style: none; border: 0; overflow: hidden;">
                  </iframe>
                </div>
              </div>
              <div style="width: 300px; height: 60px; border-style: none;
                bottom: 12px; left: 25px; margin: 0px; padding: 0px; right: 25px;
                background: #f9f9f9; border: 1px solid #c1c1c1; border-radius: 3px;">
                <textarea id="g-recaptcha-response" name="g-recaptcha-response"
                  class="g-recaptcha-response"
                  style="width: 250px; height: 40px; border: 1px solid #c1c1c1;
                  margin: 10px 25px; padding: 0px; resize: none;">
                </textarea>
              </div>
            </div>
          </noscript>

</div>
</ql-lab-control-panel>
</ql-drawer>
<ql-drawer-content id='lab-instructions' slot='drawer-content'>
<div class='alert alert--fake js-alert'>
<p class='alert__message js-alert-message'></p>
<a class='alert__close js-alert-close'>
<i class='fa fa-times'></i>
</a>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='js-lab-content lab-content__renderable-instructions'>
<div class='lab-preamble'>
<h1 class='lab-preamble__title'>
Creating and Alerting on Logs-based Metrics
</h1>
<div class='lab-preamble__details subtitle-headline-1'>
<span>1 hour 30 minutes</span>
<span>7 Credits</span>
<div class='lab__rating'>
<a href="/focuses/619/reviews?parent=catalog"><div class='rateit' data-rateit-readonly='true' data-rateit-value='0'></div>

</a></div>
</div>
</div>

<div class='js-markdown-instructions markdown-lab-instructions' id='markdown-lab-instructions'>



<h2 id="step1">GSP091</h2>
<p><img alt="Google Cloud Self-Paced Labs" src="https://cdn.qwiklabs.com/GMOHykaqmlTHiqEeQXTySaMXYPHeIvaqa2qHEzw6Occ%3D"></p>

<p><strong>Logs-based metrics</strong> are  <a href="https://cloud.google.com/monitoring/docs/" target="_blank">Cloud Monitoring</a> metrics that are based on the content of log entries. It can help you identify trends, extract numeric values out of the logs, and set up an alert when a certain log entry occurs by creating a metric for that event. You can use both system and user-defined logs-based metrics in Cloud Monitoring to create charts and alerting policies. Logs-based metrics are time series that are generated from data in logs. In this lab you'll do all of the above!</p>
<h2 id="step2">Setup and requirements</h2>
<h4>Before you click the Start Lab button</h4>
<p>Read these instructions. Labs are timed and you cannot pause them. The timer, which starts when you click <strong>Start Lab</strong>, shows how long Google Cloud resources will be made available to you.</p>
<p>This Qwiklabs hands-on lab lets you do the lab activities yourself in a real cloud environment, not in a simulation or demo environment. It does so by giving you new, temporary credentials that you use to sign in and access Google Cloud for the duration of the lab.</p>
<h4>What you need</h4>
<p>To complete this lab, you need:</p>
<ul>
<li>Access to a standard internet browser (Chrome browser recommended).</li>
<li>Time to complete the lab.</li>
</ul>
<p><strong>Note:</strong> If you already have your own personal Google Cloud account or project, do not use it for this lab.</p>
<p><strong>Note:</strong> If you are using a Pixelbook, open an Incognito window to run this lab.</p>

<h4>How to start your lab and sign in to the Google Cloud Console</h4>
<ol>
<li>
<p>Click the <strong>Start Lab</strong> button. If you need to pay for the lab, a pop-up opens for you to select your payment method.
On the left is a panel populated with the temporary credentials that you must use for this lab.</p>
<p><img alt="Open Google Console" src="https://cdn.qwiklabs.com/%2FtHp4GI5VSDyTtdqi3qDFtevuY014F88%2BFow%2FadnRgE%3D"></p>
</li>
<li>
<p>Copy the username, and then click <strong>Open Google Console</strong>.
The lab spins up resources, and then opens another tab that shows the <strong>Sign in</strong> page.</p>
<p><img alt="Sign in" src="https://cdn.qwiklabs.com/VkUIAFY2xX3zoHgmWqYKccRLwFrR4BfARLd5ojmlbhs%3D"></p>
<p><strong><em>Tip:</em></strong> Open the tabs in separate windows, side-by-side.</p>
<aside>
 If you see the <strong>Choose an account</strong> page, click <strong>Use Another Account</strong>.
<img alt="Choose an account" src="https://cdn.qwiklabs.com/eQ6xPnPn13GjiJP3RWlHWwiMjhooHxTNvzfg1AL2WPw%3D">
</aside>
</li>
<li>
<p>In the <strong>Sign in</strong> page, paste the username that you copied from the Connection Details panel. Then copy and paste the password.</p>
<p><strong><em>Important:</em></strong> You must use the credentials from the Connection Details panel. Do not use your Qwiklabs credentials. If you have your own Google Cloud account, do not use it for this lab (avoids incurring charges).</p>
</li>
<li>
<p>Click through the subsequent pages:</p>
<ul>
<li>Accept the terms and conditions.</li>
<li>Do not add recovery options or two-factor authentication (because this is a temporary account).</li>
<li>Do not sign up for free trials.</li>
</ul>
</li>
</ol>
<p>After a few moments, the Cloud Console opens in this tab.</p>
<aside>
<strong>Note:</strong> You can view the menu with a list of Google Cloud Products and Services by clicking the <strong>Navigation menu</strong> at the top-left.
<img alt="Cloud Console Menu" src="https://cdn.qwiklabs.com/9vT7xPlxoNP%2FPsK0J8j0ZPFB4HnnpaIJVCDByaBrSHg%3D">
</aside>

<h3>Activate Cloud Shell</h3>
<p>Cloud Shell is a virtual machine that is loaded with development tools. It offers a persistent 5GB home directory and runs on the Google Cloud. Cloud Shell provides command-line access to your Google Cloud resources.</p>
<p>In the Cloud Console, in the top right toolbar, click the <strong>Activate Cloud Shell</strong> button.</p>
<p><img alt="Cloud Shell icon" src="https://cdn.qwiklabs.com/vdY5e%2Fan9ZGXw5a%2FZMb1agpXhRGozsOadHURcR8thAQ%3D"></p>
<p>Click <strong>Continue</strong>.</p>
<p><img alt="cloudshell_continue.png" src="https://cdn.qwiklabs.com/lr3PBRjWIrJ%2BMQnE8kCkOnRQQVgJnWSg4UWk16f0s%2FA%3D"></p>
<p>It takes a few moments to provision and connect to the environment. When you are connected, you are already authenticated, and the project is set to your <em>PROJECT_ID</em>. For example:</p>
<p><img alt="Cloud Shell Terminal" src="https://cdn.qwiklabs.com/hmMK0W41Txk%2B20bQyuDP9g60vCdBajIS%2B52iI2f4bYk%3D"></p>
<p><code>gcloud</code> is the command-line tool for Google Cloud. It comes pre-installed on Cloud Shell and supports tab-completion.</p>
<p>You can list the active account name with this command:</p>
<pre><code>gcloud auth list&#x000A;</code></pre>
<p>(Output)</p>
<pre><code class="language-output prettyprint">Credentialed accounts:&#x000A; - &lt;myaccount&gt;@&lt;mydomain&gt;.com (active)&#x000A;</code></pre>
<p>(Example output)</p>
<pre><code class="language-Output prettyprint">Credentialed accounts:&#x000A; - google1623327_student@qwiklabs.net&#x000A;</code></pre>
<p>You can list the project ID with this command:</p>
<pre><code>gcloud config list project&#x000A;</code></pre>
<p>(Output)</p>
<pre><code class="language-output prettyprint">[core]&#x000A;project = &lt;project_ID&gt;&#x000A;</code></pre>
<p>(Example output)</p>
<pre><code class="language-Output prettyprint">[core]&#x000A;project = qwiklabs-gcp-44776a13dea667a6&#x000A;</code></pre>
<aside>
  For full documentation of <code>gcloud</code> see the <a href="https://cloud.google.com/sdk/gcloud" target="_blank">gcloud command-line tool overview</a>.

</aside>

<p>Resources are being set up for this lab, including a virtual machine. Make sure you see the green Lab Running light on the page where you started the lab before continuing.</p>
<h2 id="step3">Create resources for the lab</h2>
<p>The first resource you need for this lab is an app that generates logs. In this section, you deploy a Guestbook app to App Engine, then create some uptime checks for Cloud Monitoring to log.</p>
<p>Create an environment variable for your Project ID, which you can find on the lab page:</p>
<pre><code>export PROJECT_ID=&lt;YOUR_PROJECT_ID&gt;&#x000A;</code></pre>
<p>Use the following commands to clone the app example to your Google Cloud project:</p>
<pre><code>git clone https://github.com/GoogleCloudPlatform/appengine-guestbook-python&#x000A;</code></pre>
<pre><code>cd appengine-guestbook-python/&#x000A;</code></pre>
<pre><code>gcloud app create --project $PROJECT_ID&#x000A;</code></pre>
<p>Type in a number for the region where you want the App Engine app created.</p>
<p>Next, run:</p>
<pre><code>gcloud app deploy --project $PROJECT_ID --version 1&#x000A;</code></pre>
<p>Enter <strong>Y</strong> to continue.</p>
<pre><code>gcloud datastore indexes create --project $PROJECT_ID index.yaml&#x000A;</code></pre>
<p>Enter <strong>Y</strong> to continue.</p>
<h2 id="step4">Monitor indexes</h2>
<p>Monitor the indexes by going to <strong>Navigation menu</strong> &gt; <strong>Datastore</strong> &gt; <strong>Indexes</strong> in the Cloud Console. Give it a couple of minutes to set up. Use the <strong>Refresh</strong> button at the top of the screen. When you see a green check, the index is set up and the status should be "Serving".</p>
<p>Click <strong>Check my progress</strong> to verify the objective.</p>
<ql-activity-tracking step="1">
    Deploy a Guestbook app to App Engine and Indexes for datastore
</ql-activity-tracking>
<h2 id="step5">Prepare to install Cloud Monitoring</h2>
<h3>Create a Monitoring workspace</h3>
<p>Now set up a Monitoring workspace that's tied to your Google Cloud Project. The following steps create a new account that has a free trial of Monitoring.</p>
<ol>
<li>
<p>In the Cloud Console, click <strong>Navigation menu</strong> &gt; <strong>Monitoring</strong>.</p>
</li>
<li>
<p>Wait for your workspace to be provisioned.</p>
</li>
</ol>
<p>When the Monitoring dashboard opens, your workspace is ready.</p>
<p><img alt="Overview.png" src="https://cdn.qwiklabs.com/FfS7W1mNXshxngUuea%2BFUBXoXedgDHt0YWk1aZKHiIk%3D"></p>

<p>Click <strong>Check my progress</strong> to verify the objective.</p>
<ql-activity-tracking step="2">
    Create a Monitoring workspace
</ql-activity-tracking>
<h3>Install the Monitoring and Logging agents</h3>
<p>Agents collect data and then send or stream info to Cloud Monitoring in the Cloud Console.</p>
<p>The <em>Cloud Monitoring agent</em> is a collectd-based daemon that gathers system and application metrics from virtual machine instances and sends them to Monitoring. By default, the Monitoring agent collects disk, CPU, network, and process metrics. Configuring the Monitoring agent allows third-party applications to get the full list of agent metrics. <a href="https://cloud.google.com/monitoring/agent" target="_blank">Learn more</a>.</p>
<p>The <em>Cloud Logging agent</em> streams logs from your VM instances and from selected third-party software packages to Cloud Logging. It is a best practice to run the Cloud Logging agent on all your VM instances. <a href="https://cloud.google.com/logging/docs/agent" target="_blank">Learn more</a>.</p>
<p>To install the agents on the VM:</p>
<ol>
<li>
<p>From the <strong>Navigation Menu</strong> go to <strong>Monitoring</strong>.</p>
</li>
<li>
<p>In the Monitoring Overview window, click <strong>VIEW GCE DASHBOARD</strong>.</p>
</li>
</ol>
<p><img alt="gce_dashboard.png" src="https://cdn.qwiklabs.com/jeUXPQfML9slwcaOlmn38iGeld%2FeXpIeuGSOJkLR4EI%3D"></p>
<ol start="3">
<li>Click on the <strong>VMs Dashboard</strong> link under <strong>Compute Engine</strong>.</li>
</ol>
<p><img alt="vm_dashboard.png" src="https://cdn.qwiklabs.com/d%2B7a2S9twKGvpIE7K%2BZ1b2gPhGeLyob9%2BGQb%2BB6z434%3D"></p>
<p>You will see your VM, <strong>instance1</strong>, listed.</p>
<ol start="4">
<li>Under the <strong>Monitoring Agent Status</strong> for <strong>instance1</strong>, click <strong>Install Agent</strong>.</li>
</ol>
<p><img alt="install_agent_2.png" src="https://cdn.qwiklabs.com/nclntyVo3AwSpLO0o2ZZFLDKRzXlKencIIk04j0SoL4%3D"></p>
<p>This will bring up an <strong>Agent Details</strong> window on the right side, which is used to install the agent.</p>
<ol start="4">
<li>In the <strong>Agent Details</strong> window, ensure <strong>Debian</strong> is selected as the operating system, and click <strong>Install Agent</strong>.</li>
</ol>
<p><img alt="install_agent.png" src="https://cdn.qwiklabs.com/jUZajWQK1t1HvpH1owaXz6kMKuwj27TNwBSwwtZDx8s%3D"></p>
<p>This will generate a command that will let you SSH into your VM and installs the agent and place it into your <code>gcloud</code> command line. Press <strong>Enter</strong> to run the command. You can also see the command in the Agent details area if you need to copy it and paste into the command line.</p>
<p>Type <strong>y</strong> when asked if you want to continue and then press <strong>enter</strong> twice to not use a passphrase.</p>
<p>While the installation of the agent runs, type and enter <strong>y</strong> whenever prompted to continue.</p>
<p>A few minutes after the installation finishes you should see a green check mark under Monitoring Agent Status.</p>
<h2 id="step6">Additional resources for the lab</h2>
<p>Since this lab uses logs, it helps if you had some interesting logs. You will generate these logs with uptime checks and a VM creation alert.</p>
<h3>Create an uptime check</h3>
<p>Create a few uptime checks for the app that's running on App Engine. The uptime checks simulate load against the app. App Engine automatically captures logs from all requests and produces one log per minute, which provides data to analyze later.</p>
<ol>
<li>From the <strong>Navigation menu</strong> go to <strong>App Engine</strong>. Click on the link in the upper right corner, which ends in ".appspot.com".</li>
</ol>
<p><img alt="b8555c42e3a3fa52.png" src="https://cdn.qwiklabs.com/53eTs7El2kMKeZELvKKPeGrHIfGnNMzl6hHUlPrvJwo%3D"></p>
<p>Your App Engine Guestbook app opens in a new browser tab. Record the URL to use when you configure the uptime check.</p>
<ol start="2">
<li>
<p>Go back to the Cloud Monitoring window (<strong>Navigation menu</strong> &gt; <strong>Monitoring</strong>).</p>
</li>
<li>
<p>In the left menu, click <strong>Uptime checks</strong>, and then <strong>Create Uptime Check</strong>.</p>
</li>
<li>
<p>In the <strong>Create uptime check</strong> dialog, set the following fields:</p>
</li>
</ol>
<table>

<tr>
<th>Field</th>
<th>Value</th>
</tr>


<tr>
<td><strong>Title</strong></td>
<td>pizza check</td>
</tr>

</table>
<p>Click <strong>Next</strong>.</p>
<p>In the <strong>Target</strong> section, set the following fields:</p>
<table>

<tr>
<th>Field</th>
<th>Value</th>
</tr>


<tr>
<td><strong>Protocol</strong></td>
<td>HTTP</td>
</tr>
<tr>
<td><strong>Resource Type</strong></td>
<td>URL</td>
</tr>
<tr>
<td><strong>Hostname</strong></td>
<td>Paste in the URL for your app (that you previously recorded). Remove the <code>https://</code> and the last <code>/</code> from the URL.</td>
</tr>
<tr>
<td><strong>Path:</strong></td>
<td>/?food=pizza</td>
</tr>
<tr>
<td><strong>Check Frequency</strong></td>
<td>1 min</td>
</tr>

</table>
<p>Click <strong>Next</strong>.</p>
<p>You can use the default settings for <strong>Response Validation</strong> and <strong>Alert &amp; Notification</strong>, so click <strong>Next</strong> one more time.</p>
<ol start="5">
<li>Now, click <strong>Test</strong>.</li>
</ol>
<p>You should see a successful response.</p>
<ol start="6">
<li>Click <strong>Create</strong>.</li>
</ol>
<p>The Uptime checks window opens and lists the pizza check in the Uptime checks table.</p>
<h3>Create 2 more uptime checks</h3>
<ol>
<li>Still in the Uptime checks window, click the vertical ellipsis in line with pizza check uptime check, and then click <strong>Copy</strong>.</li>
</ol>
<p><img alt="copy-check.png" src="https://cdn.qwiklabs.com/67gXcTRu%2FYp53DHwpaz4Sl7aeXwBd4Oa%2FjShW6HN8dg%3D"></p>
<ul>
<li>
<p>Change the Title to "burger check".</p>
</li>
<li>
<p>Click <strong>Next</strong> and change the Path to "/?food=burger".</p>
</li>
<li>
<p>Click <strong>Next</strong> twice and then click <strong>Create</strong>.</p>
</li>
</ul>
<ol start="2">
<li>
<p>Copy an uptime check one more time.</p>
</li>
</ol>
<ul>
<li>Change the Title to "cake check".</li>
<li>Click <strong>Next</strong> and change the Path to "/?food=cake"</li>
<li>Click <strong>Next</strong> twice and then click <strong>Create</strong>.</li>
</ul>
<p>All three uptime checks are listed in the Uptime checks table.</p>
<p>Click <strong>Check my progress</strong> to verify the objective.</p>
<ql-activity-tracking step="3">
    Create an uptime check
</ql-activity-tracking>
<h2 id="step7">System defined and user defined logs-based metrics</h2>
<p>Logs-based metrics are divided into System Defined and User Defined.</p>
<h3>System defined logs-based metrics</h3>
<p>System defined logs-based metrics are ready to use right out of the box.These  <a href="https://cloud.google.com/monitoring/api/metrics_gcp#gcp-logging" target="_blank">system logs-based metrics</a> include:</p>
<h4>Metrics around logs ingested</h4>
<ul>
<li>
<p><code>Byte_count</code>: Number of bytes in all log entries ingested.  This is broken down by monitored resource type, log stream name, and severity level.</p>
</li>
</ul>
<h4>Metrics around logs excluded</h4>
<ul>
<li>
<p><code>Excluded_byte_count</code>: Number of bytes in log entries that were excluded.  This is broken down by the monitored resource type.</p>
</li>
<li>
<p><code>Excluded_log_entry_count</code>: Number of log entries that were excluded.  This is broken down by the monitored resource type.</p>
</li>
</ul>
<h4>Metrics around logs based metrics</h4>
<ul>
<li>
<code>Dropped_log_entry_count</code>: Despite the name, this does not show log entries dropped by Cloud logging but rather the number of log entries that did not contribute to logs based metrics because they arrived too late.</li>
<li>
<code>Log_entry_count</code>: Number of log entries that contributed to logs based metrics so that <code>dropped_log_entry_count</code> + <code>log_entry_count</code> is the total number of log entries ingested by Cloud Logging.</li>
<li>
<code>Metric_throttled</code>: Indicates if points are being dropped for logs-based metrics due to exceeding time series limits.</li>
<li>
<code>Time_series_count</code>: Estimate of the active time series count for logs-based metrics.</li>
</ul>
<p>Most system logs-based metrics are counter metrics. <strong>Counter metrics</strong> count the number of log entries that match an advanced logs filter.</p>
<p>Now you'll look more closely at a system generated logs-based metric: <code>Log_entry_count</code>.</p>
<ol>
<li>In the left menu, click <strong>Metrics Explorer</strong>:</li>
<li>To find a metric, start typing "log entries" and choose **Logging Agent Log Entry Count **. Choose the option for GCE instances.</li>
<li>Select <strong>VM Instance (GCE)</strong> as your Resource.</li>
</ol>
<p><img alt="abbf5bbac41e0742.png" src="https://cdn.qwiklabs.com/Cg1Vwmi556XBjL3NLz14Va%2Fhii2rt5OFteLuXiEM8Mk%3D"></p>
<p>You're looking at the graphical representation of log entries for the machine that was started as one of your resources when you began this lab.</p>
<h2 id="step8">User defined logs-based metrics</h2>
<p>Create your own logs-based metrics using data from existing logs. These are called <strong>user defined logs-based metrics</strong>. In this section, you create a metric using a log entry.</p>
<ol>
<li>Select <strong>Navigation menu</strong> &gt; <strong>Logging</strong> &gt; <strong>Logs Explorer</strong>.</li>
</ol>
<p>The Cloud Logging window opens.</p>
<ol start="2">
<li>
<p>Filter for activity logs from VM instance you previously created.</p>
</li>
</ol>
<ul>
<li>In the <strong>Resource</strong> dropdown, select <strong>VM Instance</strong> and click <strong>Add</strong>.</li>
</ul>
<p><img alt="VMInstance5.png" src="https://cdn.qwiklabs.com/S7ftkN9IidGpYl0HiPKwVhwGF1dvyam9OTjdfFxIsco%3D"></p>
<ul>
<li>In the <strong>Log name</strong>  dropdown, select <strong>activity</strong>, then click <strong>Add</strong>.</li>
</ul>
<p><img alt="Activity6.png" src="https://cdn.qwiklabs.com/xGxYoKJRlTyqSIyyzpeq3wEVFWIdPCWP3D8gJpO%2F3Es%3D"></p>
<ul>
<li>Click <strong>Run Query</strong>.</li>
</ul>
<p><img alt="ActivityLogs1.png" src="https://cdn.qwiklabs.com/sKENlZN8n7RNwn9J4WfoFRIxnUosxn3lKfYCd8YPids%3D"></p>
<ol start="3">
<li>In one of the entries, click on the "insert" tag, then select <strong>Show matching entries</strong>.</li>
</ol>
<p><img alt="MatchingEntries2.png" src="https://cdn.qwiklabs.com/d6u5lVYf7QLUhXeI3Ua7ssorbm5sn%2B51LC1YsO1grBY%3D"></p>
<p>The <strong>Query builder</strong> is now displays the criteria for this metric.</p>
<p><img alt="Metric3.png" src="https://cdn.qwiklabs.com/1h5reWZjEIycC1IdiMSJoiJh4SXYpo07fNv%2Fp1insiU%3D"></p>
<p>The <code>protoPayload.methodName</code> in the 3rd row lets you filter on many methods. You can read more about that <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging" target="_blank">here</a>.</p>
<ol start="4">
<li>
<p>On top right of the Query Results section, click <strong>Actions</strong> drop down and select <strong>Create Metric</strong>.</p>
</li>
<li>
<p>For the Log Metric Name type "newVM" then click <strong>Create Metric</strong>.</p>
</li>
</ol>
<p>You will see a success message at the top of the page.</p>
<h3>Create alerting policy for the VM creation metric</h3>
<p>Create an alert to let you know when a new VM gets added to your project.</p>
<ol>
<li>
<p>Return to the Cloud Monitoring window (<strong>Navigation menu</strong> &gt; <strong>Monitoring</strong>).</p>
</li>
<li>
<p>In the left menu, click <strong>Alerting</strong>, and then click <strong>Create Policy</strong>.</p>
</li>
<li>
<p>Click <strong>Add Condition</strong> and set the following:</p>
</li>
</ol>
<ul>
<li>For Target, click inside the dropdown menu scroll up and choose <strong>VM Instance</strong>.</li>
<li>For the metric, start typing "logging/" and select <strong>logging/user/newVM</strong>.</li>
<li>For Configuration, set Condition to <strong>is above</strong> the Threshold <strong>0</strong> For <strong>1 minute</strong>.</li>
<li>Click <strong>Add</strong>.</li>
</ul>
<ql-warningbox>
If "logging/user/newVM" isn't coming up as a metric when searching, try refreshing your browser. If it still doesn't come up after refreshing, double check that the last step was completed correctly.
</ql-warningbox>
<p>Click <strong>Next</strong>.</p>
<ol start="4">
<li>Click the <strong>Notification Channels</strong> dropdown and click <strong>Manage Notification Channels</strong>.</li>
</ol>
<p>In the tab that comes up, find <strong>Email</strong> and click <strong>Add New</strong>. Add your personal email and either your name or an alias for the <strong>Display Name</strong>.</p>
<p>Now, back in the <strong>Create Alerting Policy</strong> tab, select the <strong>Notification Channels</strong> dropdown and click the <strong>refresh</strong> button.</p>
<p>You should see the display name of your email with a check box next to it. Select the checkbox next to your email's display name.</p>
<p>Click <strong>Next</strong>.</p>
<ol start="5">
<li>
<p>Enter "New Virtual Machine" as the <strong>Alert Name</strong>.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
<h3>Create a new instance</h3>
<p>To trigger the alert you just created, go create a new virtual machine instance.</p>
<ol>
<li>
<p>In the Cloud Console dashboard, go to <strong>Navigation menu</strong> &gt; <strong>Compute Engine</strong> &gt; <strong>VM instances</strong>, then click <strong>Create Instance</strong> at the top of the screen.</p>
</li>
<li>
<p>Name your instance <strong>instance2</strong>, then check the firewall boxes to <strong>allow HTTP and HTTPs traffic</strong>. Leave all the other fields with their default values.</p>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
</ol>
<p>Wait a couple of minutes for your instance to be launched. You should see an Incident in Cloud Monitoring console in 3-5 minutes.</p>
<p>Continue with the lab, you can check these results at the end.</p>
<p>Click <strong>Check my progress</strong> to verify the objective.</p>
<ql-activity-tracking step="4">
    Create user defined logs-based metrics
</ql-activity-tracking>
<h2 id="step9">Labels and user defined metrics</h2>
<p>User defined labels can be created when you create a metric. An extractor expression is required for each configured label to tell Cloud Logging how to extract values from logs and place them as the labels' value. You cannot add labels to system logs-based metrics.</p>
<p>Create a user-defined metric with a label.</p>
<ol>
<li>
<p>Select <strong>Navigation menu</strong> &gt; <strong>Logging</strong> &gt; <strong>Logs Explorer</strong>.</p>
</li>
<li>
<p>In <strong>Resource</strong> drop-down, select <strong>GAE Application</strong> and click <strong>Add</strong>.</p>
</li>
</ol>
<p><img alt="gae_appln.png" src="https://cdn.qwiklabs.com/8EScriMwudhLpx1cxXwoc2mcaNX5OKLt6JHTsSKq0WA%3D"></p>
<ol start="3">
<li>For <strong>Log name</strong>, select <strong>request_log</strong> and click <strong>Add</strong>.</li>
</ol>
<p><img alt="request_log.png" src="https://cdn.qwiklabs.com/iB%2BxCJ1DTSv7DCN%2FEeSwBQExEWJDY6d476Erre87XuY%3D"></p>
<ol start="4">
<li>
<p>Select <strong>Actions &gt; Create Metric</strong>.</p>
</li>
<li>
<p>Name your metric "Foodcount" and add a Description.</p>
</li>
<li>
<p>Click on <strong>Add label</strong> to create a Label.</p>
</li>
</ol>
<p><img alt="add_label.png" src="https://cdn.qwiklabs.com/QNpHuHH8fldaWk%2BLUuaQnfcX7UeJjra72dEPbzsYc7w%3D"></p>
<h2 id="step10">Labels</h2>
<p><a href="https://cloud.google.com/logging/docs/logs-based-metrics/labels#create-label" target="_blank">Labels</a> allow logs-based metrics to contain multiple time series — one for each label value. All logs-based metrics come with some default labels.</p>
<p>For this lab you'll create a metric for when an uptime check log occurs that has "food" in the log.</p>
<ol>
<li>
<p>Go back to what you're doing, which is creating a Metric. In the Metric Editor, you've named your metric Foodcount, and clicked <strong>Add label</strong> to create a label.</p>
</li>
<li>
<p>Set the following:</p>
</li>
</ol>
<ul>
<li>Label name: food</li>
<li>Label type: String</li>
<li>Field Name: search for "resource" and choose <strong>protoPayload.resource</strong>.</li>
<li>Regular expressions: <code>/?food=(.*)</code>
</li>
<li>Click <strong>Done</strong>
</li>
</ul>
<p><img alt="add_label_2.png" src="https://cdn.qwiklabs.com/ShoElVzYCOU7lRsDfo5NTL2GUCTyE5hkDb3nvPASAEc%3D"></p>
<p><strong>Caution:</strong> Be sure to specify the extractor for your label values carefully. A mistake can result in having a large number of active time series. Exceeding time series limits can result in the metric being throttled, a degradation in the performance of charts, or extra time series overage costs.</p>
<p>Click <strong>Create Metric</strong>.</p>
<p>If you click on <strong>Logs-based Metrics</strong> on the left side you'll see your user-defined metric added to the logs-based metrics screen.</p>
<p><img alt="user_defined_metrics.png" src="https://cdn.qwiklabs.com/tj3%2FxOETpjdn2ttd4SIrBO%2BkGB%2FpoDxGxcrrTdHYgiI%3D"></p>
<p>Click <strong>Check my progress</strong> to verify the objective.</p>
<ql-activity-tracking step="5">
  Create labels and user defined metrics
</ql-activity-tracking>
<h2 id="step11">Create the Foodcount alerting policy</h2>
<p>Now you'll create an alert policy for Foodcount, the metric you just made.</p>
<ol>
<li>
<p>Select <strong>Navigation menu</strong> &gt; <strong>Monitoring</strong> &gt; <strong>Alerting</strong>, and then click <strong>Create Policy</strong>.</p>
</li>
<li>
<p>Click <strong>Add Condition</strong> and set the following:</p>
</li>
</ol>
<ul>
<li>In the Find resource type and metric field, start typing "logging/user/" and select <strong>logging/user/Foodcount</strong>. If this metric doesn't appear, close the window and try again.</li>
<li>For Configution, Condition <strong>is above</strong>, with a Threshold of <strong>0</strong>, For <strong>1 minute</strong>.</li>
<li>Click <strong>Add</strong>.</li>
</ul>
<p>Click <strong>Next</strong>.</p>
<ol start="3">
<li>To receive an email notification, click on <strong>Notification Channels</strong> dropdown and select the checkbox next to your email's display name you have previously created in the lab.</li>
</ol>
<p>Click <strong>Next</strong>.</p>
<ol start="4">
<li>Name this policy "food alert".</li>
</ol>
<p>Click <strong>Save</strong>.</p>
<p>When the next round of uptime checks happen, they should violate the policy since the threshold will be higher than 0, and you'll see an Incident on the Monitoring Overview page.</p>
<p>Click <strong>Check my progress</strong> to verify the objective.</p>
<ql-activity-tracking step="6">
  Create the Foodcount alerting policy
</ql-activity-tracking>


<h2 id="step12">Custom dashboard with heatmap</h2>
<p>Creating a custom dashboard to show you a specific metric is a great way to see your data. Next you'll create a custom dashboard to show the same latency metric you just used.</p>
<ol>
<li>
<p>Still on the Cloud Monitoring window, in the left menu, click <strong>Dashboards</strong> &gt; <strong>Create Dashboard</strong>.</p>
</li>
<li>
<p>Name the Dashboard "App Response".</p>
</li>
<li>
<p>Select <strong>Heatmap</strong> option in Chart Library, and then set the following:</p>
</li>
</ol>
<p><img alt="heatmap.png" src="https://cdn.qwiklabs.com/lk%2BOg2yWKZLbvjpGTvFEOf4qiESSd2kPjW87DT5CqT8%3D"></p>
<ul>
<li>
<p><strong>Resource type:</strong> GAE Application</p>
</li>
<li>
<p><strong>Metric:</strong> Response latency (If the option is not visible, deselect the <strong>only show active</strong> checkbox)</p>
</li>
<li>
<p>The chart names itself the metric that you're using. You can change the Chart Title to whatever you want - this example uses "Heatmap".</p>
</li>
</ul>
<p><img alt="e1d16442faa95ab3.png" src="https://cdn.qwiklabs.com/oeLhFeeANtK8CBeN9hyg%2BEJJtYjuymyZK7ALFylvEQ0%3D"></p>
<h2 id="step13">Check for the alert</h2>
<p>Still in the <strong>Cloud Monitoring</strong> window, in the left menu, click <strong>Monitoring overview</strong> to check for alerts from the uptime check policies.</p>
<p>To see the newVM alert more clearly, click the policy listed in the <strong>Alerting</strong> section.</p>
<p>To see the status of uptime checks in each region, in the left menu, click <strong>Uptime Checks</strong>.</p>
<p>If you set up any email notifications, check the account you added to your alert to verify that you've been notified. These may take longer to arrive, but you can see the emails even after the lab has ended.</p>
<p><img alt="Stackdriver_all_alerts.png" src="https://cdn.qwiklabs.com/EuZcHUu6fgbJS%2BTkBDPxEt8eUeJ%2FDnoa8rQVxEF2D%2Fg%3D"></p>
<h2 id="step14">Congratulations!</h2>
<p><img alt="4588136b652766c0.png" src="https://cdn.qwiklabs.com/v9Q2F9GfjA%2Ff5nwcDjkXPkJaN1L51MLqa%2BhmudOLIaM%3D">
<img alt="stackdriver-logging-badge.png" src="https://cdn.qwiklabs.com/nlpPIy%2FR6s00iUunMbyJXm2DB9VZt229C6Hlif63SRc%3D"></p>
<h3>Finish Your Quest</h3>
<p>This self-paced lab is part of the Qwiklabs <a href="https://google.qwiklabs.com/quests/35" target="_blank">Google Cloud's Operations Suite</a> and  <a href="https://google.qwiklabs.com/quests/81" target="_blank">Cloud Logging</a> Quests. A Quest is a series of related labs that form a learning path.  Completing a Quest earns you the badge above, to recognize your achievement. You can make your badge (or badges) public and link to them in your online resume or social media account. Enroll in either Quest and get immediate completion credit if you've taken this lab.  <a href="https://google.qwiklabs.com/catalog" target="_blank">See other available Qwiklabs Quests</a>.</p>
<h3>Take Your Next Lab</h3>
<p>Continue your Quest with  <a href="https://google.qwiklabs.com/catalog_lab/756" target="_blank">Autoscaling an Instance Group with Custom Metrics</a>, or check out these suggestions:</p>
<ul>
<li>
<p><a href="https://google.qwiklabs.com/catalog_lab/755" target="_blank">Monitoring Multiple Projects with Cloud Monitoring</a></p>
</li>
</ul>
<h3>Next Steps / Learn More</h3>
<ul>
<li>Read about using BigQuery and Cloud Monitoring together in this blog post:  <a href="https://cloud.google.com/blog/big-data/2017/10/accelerate-bigquery-solution-development-with-intelligent-log-analysis" target="_blank">https://cloud.google.com/blog/big-data/2017/10/accelerate-bigquery-solution-development-with-intelligent-log-analysis</a>
</li>
</ul>
<h3>Google Cloud Training &amp; Certification</h3>
<p>...helps you make the most of Google Cloud technologies. <a href="https://cloud.google.com/training/courses" target="_blank">Our classes</a> include technical skills and best practices to help you get up to speed quickly and continue your learning journey. We offer fundamental to advanced level training, with on-demand, live, and virtual options to suit your busy schedule. <a href="https://cloud.google.com/certification/" target="_blank">Certifications</a> help you validate and prove your skill and expertise in Google Cloud technologies.</p>

<h5>Manual Last Updated May 3, 2021</h5>
<h5>Lab Last Tested May 3, 2021</h5>
<p>Copyright 2021 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>



</div>
</div>


<div class='hidden js-end-lab-button-container lab-content__end-lab-button'>
<ql-lab-control-button class='js-end-lab-button' running></ql-lab-control-button>
</div>
<!-- / TODO: Move recommendations into the end lab modal -->
<div class='lab-content__renderable-instructions'>
<div class='lab-content__recommendation'>
<!-- # TODO: Change classes so that this doesn't stack vertically -->
<section class='upcoming-cards'>
<h2 class='ql-headline-4'>Continue questing</h2>
<div class='content-card-grid'>
<div class='card-content-wrapper js-content-card' data-id='753' data-level='Advanced' data-name='Creating and Alerting on Logs-based Metrics' data-type='Lab'>
<a class="card card--content elevation-0 content-lab" href="/focuses/619?parent=catalog"><div class='card__image'>
<div class='card__image__inner' style='background-image: url(https://cdn.qwiklabs.com/assets/fractal4-1d205807c54d90fe4382315dbfc0dd665ddb825bbc90f3ca5db7d7170fa0df1b.jpg)'></div>
</div>
<div class='card__body'>
<div class='overline card--content__type'>
Lab
</div>
<h3 class='card--content__title'>
Creating and Alerting on Logs-based Metrics
</h3>
<div class='card--content__description body-1'>
<p>
In this hands-on lab we take a look through some of the information provided by the Cloud Monitoring tools, and teach some of the concepts you will need to know to take advantage of Cloud Monitoring effectively.
</p>
</div>
</div>
<div class='card__footer'>
<div class='card__footer__left'>
<span>Advanced</span>
</div>
</div>
</a></div>

</div>
</section>

</div>

</div>
</ql-drawer-content>
<ql-drawer end id='outline-drawer' open slot='drawer' width='320'>
<div class='js-lab-content-outline lab-content__outline'>
<a href='#step1'>GSP091</a><a href='#step2'>Setup and requirements</a><a href='#step3'>Create resources for the lab</a><a href='#step4'>Monitor indexes</a><a href='#step5'>Prepare to install Cloud Monitoring</a><a href='#step6'>Additional resources for the lab</a><a href='#step7'>System defined and user defined logs-based metrics</a><a href='#step8'>User defined logs-based metrics</a><a href='#step9'>Labels and user defined metrics</a><a href='#step10'>Labels</a><a href='#step11'>Create the Foodcount alerting policy</a><a href='#step12'>Custom dashboard with heatmap</a><a href='#step13'>Check for the alert</a><a href='#step14'>Congratulations!</a>
</div>
</ql-drawer>
</ql-drawer-container>
</ql-drawer-content>
</ql-drawer-container>
<div class='lab-introduction js-lab-introduction is-hidden'>
<div class='lab-introduction__inner'>
<h1 class='headline-1'>Welcome to Your First Lab!</h1>
<ql-icon-button class='js-skip-button'>close</ql-icon-button>
<div class='lab-introduction__video'>
<iframe allow='autoplay; encrypted-media' allowfullscreen frameborder='0' id='lab-introduction' src='https://www.youtube.com/embed/yF7EDXKTmoQ?enablejsapi=1&amp;rel=0&amp;showinfo=0'></iframe>
</div>
<a class='js-skip-button button button--outline'>Skip this video</a>
</div>
</div>



</div>
</main>


<div class='modal fade' id='lab-details-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<div class='modal-body'>
<p class='l-mbm'>
In this hands-on lab we take a look through some of the information provided by the Cloud Monitoring tools, and teach some of the concepts you will need to know to take advantage of Cloud Monitoring effectively.
</p>
<p>
This lab is included in these quests:
<a href="/quests/35">Google Cloud&#39;s Operations Suite</a>, <a href="/quests/143">Monitor and Log with Google Cloud Operations Suite</a>, <a href="/quests/81">Cloud Logging</a>.
If you complete this lab you&#39;ll receive credit for it when you enroll in one of these quests.
</p>
<p class='small-label l-mbs'>
<strong>
Duration:
</strong>
5m setup
&middot;
90m access
&middot;
45m completion
</p>
<p class='small-label l-mbs'>
<span><strong>Levels: </strong>advanced</span>
</p>
<p class='small-label'>
<strong>
Permalink:
</strong>
<a href="https://www.qwiklabs.com/catalog_lab/753">https://www.qwiklabs.com/catalog_lab/753</a>
</p>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Got It
</a>
</div>


</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='modal fade' id='lab-review-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<form class="simple_form js-lab-review-form" id="new_lab_review" action="/lab_reviews" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='modal-body'>
<p class='label'>
How satisfied are you with this lab?*
</p>
<div class='rateit js-rateit' data-rateit-max='5' data-rateit-min='0' data-rateit-resetable='false' data-rateit-step='1' data-rateit-value='0'></div>
<div class='l-mtm'>

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="3894861" name="lab_review[user_id]" id="lab_review_user_id" /></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[classroom_id]" id="lab_review_classroom_id" /></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="753" name="lab_review[lab_id]" id="lab_review_lab_id" /></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[focus_id]" id="lab_review_focus_id" /></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" name="lab_review[rating]" id="lab_review_rating" /></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Comment</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment">
</textarea></div></div>
</div>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Cancel
</a>
<input type="submit" name="commit" value="Submit" disabled="disabled" id="submit" data-disabled="false" class="button" data-disable-with="Submit" />
</div>
</form>

</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='modal fade' id='lab-access-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<a class='lab-access-modal-close' data-analytics-action='dismissed_lab_payment_modal' data-dismiss='modal'>
<i class='material-icons'>close</i>
</a>
<form class="js-lab-access-form" action="/lab_onetime_coupons/activate?parent=catalog" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />
<div class='modal-body'>
<div class='lab-access-modal'>
<input type="hidden" name="id" id="id" value="619" />
<input type="hidden" name="user_id" id="user_id" value="3894861" />
<input type="hidden" name="launch_with_credits" id="launch_with_credits" value="0" class="js-launch-with-credits-input" />
<input type="hidden" name="launch_with_subs" id="launch_with_subs" value="0" class="js-launch-with-subscription-input" />
<input type="hidden" name="launch_with_access_code" id="launch_with_access_code" value="0" class="js-launch-with-access-code" />
<div class='lab-access-modal__method'>
<p>
This lab costs
7 Credits.
</p>
<p>
1940 Credits
available
</p>
<a class='button js-launch-with-credits-button js-lab-access-modal-button' data-analytics-action='clicked_launch_with_credits_button'>
Launch with
7 Credits
</a>
</div>
<div class='lab-access-modal__method'>
<p>
Enter Lab Access Code:
</p>
<div class='lab-access-modal__code js-access-code'>
<input type="text" name="uuid_1" id="uuid_1" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
<input type="text" name="uuid_2" id="uuid_2" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
<input type="text" name="uuid_3" id="uuid_3" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
<input type="text" name="uuid_4" id="uuid_4" value="" maxlength="4" placeholder="1234" class="js-access-code-input" />
</div>
<a class='button js-launch-with-access-code-button js-lab-access-modal-button' data-analytics-action='clicked_launch_with_access_code_button'>
Launch with Access Code
</a>
</div>
</div>
</div>
</form>



</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>


<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    ql.favoriting.init();
  ql.labControlPanel.addRecaptchaErrorHandler();
  initLabContent();
  ql.labOutline.links.init();
  initLabReviewModal();
  initLabAccessModal();
  ql.labAssessment.init();
  ql.labIntroduction.init( true );
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?\n","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.\n","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>

</body>
</html>

