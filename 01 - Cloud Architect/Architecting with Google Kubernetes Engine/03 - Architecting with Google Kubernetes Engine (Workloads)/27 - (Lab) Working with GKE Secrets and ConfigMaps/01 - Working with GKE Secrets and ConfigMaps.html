
<!DOCTYPE html>
<html lang='en'>
<head>
<title>Working with Google Kubernetes Engine Secrets and ConfigMaps | Qwiklabs</title>
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"DANIEL","lastname":"ENRIQUE SANDOVAL SANCHEZ","fullname":"DANIEL ENRIQUE SANDOVAL SANCHEZ","company":"Coursera","email":"desandovals@liverpool.com.mx","origin":"googlecoursera-run, lti-coursera","subscriptions":0,"id":"40414ff5fc280f833d9acca966912f93","qlCreatedAt":"2020-11-17 20:45:59 UTC","optIn":null,"current_organization_id":null,"current_organization_role":null};gon.segment="j4Im8pqIko0Lxq4wVVZWMPMM0EroHUvb";gon.deployment="googlecoursera-run";gon.content={"type":"Lab","id":2304,"name":"Working with Google Kubernetes Engine Secrets and ConfigMaps"};
//]]>
</script>
<script>
  dataLayer = [
    {user: gon.current_user},
    {content: gon.content}
  ];
</script>
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-TQR88QK");
</script>
<script>
  EVENT_SOURCE_BASE_URL = "https://googlecoursera-run.qwiklabs.com/nchan-sub?id=";
</script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/polyfills/webcomponents-loader-408088dc333247a761de5f2b2a4ba1cabd2bc36579f83ba92a559eb3682a9b77.js"></script>
<script src="https://cdn.qwiklabs.com/assets/vendor-45d462772c30000424907184f70c7157e95fb6227698d1671c5051818a6f60d8.js"></script>
<script src="https://cdn.qwiklabs.com/assets/application-6874b164d8346f46605fc772a6f7375a39626ffc9f6d168e23a3a8c40bb6fd28.js"></script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/hallofmirrors-b7ff781d00ceebdf75589f58475cea695bafd8d5cc1f3eb4baf6122ed4a4b736.js"></script>
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script type='application/ld+json'>
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script id='ze-snippet' src='https://static.zdassets.com/ekr/snippet.js?key=511e4158-0aec-4e3c-b2e6-4daa1769f51e'></script>


<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="y4X3G2KjNUDBJuhEQgp6Wo3AUOpg7Zx9B32VK4vCODgfP372vdUQftCuxn1IRmvZ8Dr5NFfbYhbbxTWEpgPOtg==" />
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0' name='viewport'>
<meta content='1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0' name='google-site-verification'>
<meta content='#3681E4' property='msapplication-TileColor'>
<meta content='/favicon-144.png' property='msapplication-TileImage'>
<meta content='[{&quot;id&quot;:&quot;recaptcha_experiment&quot;,&quot;optimize_id&quot;:&quot;dpViOcLkT3qS4TvL2mRojA&quot;,&quot;title&quot;:&quot;No Recaptcha shown for trusted users&quot;,&quot;variant_index&quot;:0,&quot;variant&quot;:&quot;original&quot;}]' name='active-experiments'>
<meta content='{&quot;userId&quot;:3894861}' name='help-api-product-data'>
<meta content='Architecting with Google Kubernetes Engine: Working with Kubernetes Engine Secrets and ConfigMaps' name='description'>
<meta content='Qwiklabs' name='author'>
<meta content='Working with Google Kubernetes Engine Secrets and ConfigMaps | Qwiklabs' property='og:title'>
<meta content='website' property='og:type'>
<meta content='/favicon-144.png' property='og:image'>
<meta content='Qwiklabs' property='og:site_name'>
<meta content='Architecting with Google Kubernetes Engine: Working with Kubernetes Engine Secrets and ConfigMaps' property='og:description'>
<meta content='/qwiklabs_logo_900x887.png' property='og:logo' size='900x887'>
<meta content='/qwiklabs_logo_994x187.png' property='og:logo' size='994x187'>


<link href='/favicon-32.png' rel='shortcut icon'>
<link color='#3681E4' href='/favicon-svg.svg' rel='mask-icon'>
<link href='/favicon-180.png' rel='apple-touch-icon-precomposed'>



<link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Oswald:400|Roboto+Mono:400,700|Roboto:300,400,500,700|Google+Sans:300,400,500,700|Google+Sans+Display:400|Material+Icons|Google+Material+Icons" />


<link rel="stylesheet" media="all" href="https://cdn.qwiklabs.com/assets/application-cf67fd00dd904ecce1e24779d7504aefc7fbd5d00696246fa80212743a81bf07.css" />



</head>
<body class='lab-show l-full no-nav application-new focuses focuses-show lab-show l-full no-nav '>
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-TQR88QK' style='display:none;visibility:hidden;' width='0'></iframe>
</noscript>
<span class='hidden' id='flash-sibling-before'></span>

<div class='header-container'>
<div class='header'>
<ql-icon-button class='js-nav-toggle header__nav-panel-button l-mrm'>menu</ql-icon-button>
<div class='header__title'>
<ql-icon-button label="Back" href="https://www.coursera.org/" id="eba9c14652d8bb9b" target="_self">arrow_back</ql-icon-button><div class="mdl-tooltip" data-mdl-for="eba9c14652d8bb9b">Back</div>

<h1 class='headline-5'>
Working with Google Kubernetes Engine Secrets and ConfigMaps
</h1>
</div>
<div class='header__actions'>
<ql-icon-button class='header__button--search js-header-search-bar-button'>search</ql-icon-button>
<ql-icon-button id='control-panel-target' style='display: none;'>
dashboard
</ql-icon-button>
<ql-menu for='control-panel-target' id='control-panel-menu'></ql-menu>

<ql-icon-button id='help-menu-button'>help</ql-icon-button>
<div class='mdl-tooltip js-tooltip' data-mdl-for='help-menu-button'>
Help
</div>
<ql-menu for='help-menu-button' id='help-menu'>
<ql-menu-item>
<ql-help context='lab' data-analytics-action='opened_help' data-analytics-label='lab' productdata='{&quot;userId&quot;:3894861}'>
Help Center
</ql-help>
</ql-menu-item>
<ql-menu-item>
<a target="_blank" class="ql-body-1" href="https://support.google.com/qwiklabs/contact/contact_us">Email support</a>
</ql-menu-item>
<ql-menu-item>
<a class='ql-body-1' onClick='ql.chat.open()'>Chat support</a>
</ql-menu-item>
</ql-menu>

<ql-icon-button id='language'>language</ql-icon-button>
<div class='mdl-menu mdl-menu__bottom-right mdl-js-menu elevation-3' for='language'>
<a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ar" href="/focuses/15531574?locale=ar&amp;parent=lti_session">العربية‬‎
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="de" href="/focuses/15531574?locale=de&amp;parent=lti_session">Deutsch
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="en" href="/focuses/15531574?locale=en&amp;parent=lti_session">English
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="es" href="/focuses/15531574?locale=es&amp;parent=lti_session">español (Latinoamérica)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="fr" href="/focuses/15531574?locale=fr&amp;parent=lti_session">français
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="id" href="/focuses/15531574?locale=id&amp;parent=lti_session">bahasa Indonesia
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="it" href="/focuses/15531574?locale=it&amp;parent=lti_session">Italiano
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ja" href="/focuses/15531574?locale=ja&amp;parent=lti_session">日本語
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ko" href="/focuses/15531574?locale=ko&amp;parent=lti_session">한국어
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pl" href="/focuses/15531574?locale=pl&amp;parent=lti_session">Polski
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_BR" href="/focuses/15531574?locale=pt_BR&amp;parent=lti_session">português (Brasil)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_PT" href="/focuses/15531574?locale=pt_PT&amp;parent=lti_session">português (Portugal)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ru" href="/focuses/15531574?locale=ru&amp;parent=lti_session">русский
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="tr" href="/focuses/15531574?locale=tr&amp;parent=lti_session">Türkçe
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh" href="/focuses/15531574?locale=zh&amp;parent=lti_session">简体中文
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh_TW" href="/focuses/15531574?locale=zh_TW&amp;parent=lti_session">繁體中文
</a></div>
<button class='icon-button' id='my_account'>
<ql-avatar></ql-avatar>
</button>
<ql-menu for='my_account' open>
<div class='my-account-menu'>
<ql-avatar class='l-mtl l-mbl' size='120'></ql-avatar>
<div class='my-account-menu__user-info l-mbl'>
<h4 class='ql-subhead-1'>DANIEL ENRIQUE SANDOVAL SANCHEZ</h4>
<p class='ql-body-2 text--light'>desandovals@liverpool.com.mx</p>
<p class='ql-body-2 text--light'>
</p>
<a class="text--green ql-subhead-2" href="/my_account/payments"><ql-chip positive>
0 Credits
</ql-chip>
</a></div>
<div class='buttons l-mbl'>
<a class="button button--hairline" id="settings" href="/my_account/profile">Settings</a>
</div>
<hr>
<ql-button data-analytics-action='clicked_sign_out' href='/users/sign_out' method='delete'>
Sign Out
</ql-button>
<div class='privacy l-mtl'>
<a class="ql-caption text--light" href="/privacy_policy">Privacy</a>
<span class='ql-caption text--light l-mls l-mrs'>&middot;</span>
<a class="ql-caption text--light" href="/terms_of_service">Terms</a>
</div>
</div>
</ql-menu>

</div>
</div>
<div class='header__search-bar js-header-search-bar'>
<form class="js-search-form-mobile" onsubmit="ql.searchFilter(); return false;" action="/searches/elasticsearch" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="Sk1dKzykchKa4MrgLn1f8s5scjSfzjttZQxXf9f3rpSe99TG49JXLIto5NkkMU5xs5bb6qj4xQa5tPfQ+jZYGg==" />
<input type="text" name="keywords" id="keywords" placeholder="Search" maxlength="255" aria-label="catalog search bar" />
</form>

<ql-icon-button class='js-close-search-bar'>close</ql-icon-button>
</div>
</div>

<nav class='nav-bar'>
<a class="nav-bar__item js-navigation-button" href="/"><ql-icon class='nav-bar__item__icon'>
home
</ql-icon>
<span class='nav-bar__item__label'>
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="/catalog"><ql-icon class='nav-bar__item__icon'>
school
</ql-icon>
<span class='nav-bar__item__label'>
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="/my_learning"><ql-icon class='nav-bar__item__icon'>
event_note
</ql-icon>
<span class='nav-bar__item__label'>
My Learning
</span>
</a>
</nav>

<nav class='nav-panel js-nav-panel'>
<div class='nav-panel__logo'>
<div class='logo logo--blue'></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="/"><ql-icon class='nav-panel__item__icon'>
home
</ql-icon>
<div class='nav-panel__item__label'>
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button" href="/catalog"><ql-icon class='nav-panel__item__icon'>
school
</ql-icon>
<div class='nav-panel__item__label'>
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_learning"><ql-icon class='nav-panel__item__icon'>
event_note
</ql-icon>
<div class='nav-panel__item__label'>
My Learning
</div>
</a>
<div class='nav-panel__spacer'></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/profile"><ql-icon class='nav-panel__item__icon'>
account_circle
</ql-icon>
<div class='nav-panel__item__label'>
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/credits"><ql-icon class='nav-panel__item__icon'>
money
</ql-icon>
<div class='nav-panel__item__label'>
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="/my_account/security"><ql-icon class='nav-panel__item__icon'>
security
</ql-icon>
<div class='nav-panel__item__label'>
Security
</div>
</a>
<div class='nav-panel__spacer'></div>
<a class="nav-panel__item" tabindex="-1" href="#"><ql-help>
<div class='nav-panel__help-item'>
<ql-icon class='nav-panel__item__icon'>help</ql-icon>
<div class='nav-panel__item__label'>
Help
</div>
</div>
</ql-help>
</a><div class='nav-panel__small-links'>
<a tabindex="-1" href="/privacy_policy">Privacy</a>
<a tabindex="-1" href="/terms_of_service">Terms</a>
</div>
</nav>
<div class='nav-panel__overlay js-nav-toggle'></div>

<main class='js-main'>
<div class='l-main-wrapper' id='main-wrapper'>







<div class='lab-assessment__tab js-open-lab-assessment-panel'>
<h6 class='js-lab-assessment-total-score'>
&mdash;/20
</h6>
</div>
<div class='lab-assessment__panel js-lab-assessment-panel'>
<div class='lab-assessment__panel__header'>
<h4>Checkpoints</h4>
<ql-icon-button class='js-close-lab-assessment-panel'>arrow_forward</ql-icon-button>
</div>
<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Work with Secrets
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='1'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-1'>
</span>
/ 10
</p>
</div>
</div>

<div class='lab-assessment__step'>
<p class='lab-assessment__step__title'>
Work with ConfigMaps
</p>
<div class='lab-assessment__step__action'>
<a class='button js-show-run-step-button' step_no='2'>
Check my progress
</a>
<p class='lab-assessment__step__score'>
<span class='js-assessment-step-score-2'>
</span>
/ 10
</p>
</div>
</div>

</div>
<ql-drawer-container class='js-lab-state' data-analytics-payload='{&quot;label&quot;:&quot;Working with Google Kubernetes Engine Secrets and ConfigMaps&quot;,&quot;lab_name&quot;:&quot;Working with Google Kubernetes Engine Secrets and ConfigMaps&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;googlecoursera-run&quot;}' data-focus-id='15531574' data-lab-billing-limit='0.0' data-lab-duration='3600' data-parent='lti_session' data-recaptcha-enabled id='lab-container'>
<ql-drawer id='terminal-drawer' slot='drawer' style='width: calc(100% - 480px)'>
<iframe allow='clipboard-read' class='terminal' id='embedded-resource'></iframe>
</ql-drawer>
<ql-drawer-content class='js-lab-wrapper' id='lab-content' slot='drawer-content'>
<ql-drawer-container id='lab-content-container'>
<ql-drawer id='control-panel-drawer' open slot='drawer' width='320'>
<ql-lab-control-panel class='ql-lab-control-panel__max-height control-panel js-lab-control-panel' connectionFiles='[]' labControlButton='{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}' labDetails='[]' labTimer='{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:3600}' studentResources='[]'>
<script src="https://www.recaptcha.net/recaptcha/api.js?render=6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr"   ></script>
        <script>
          // Define function so that we can call it again later if we need to reset it
          // This executes reCAPTCHA and then calls our callback.
          function executeRecaptchaForStartLab() {
            grecaptcha.ready(function() {
              grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}).then(function(token) {
                setInputWithRecaptchaResponseTokenForStartLab('g-recaptcha-response-data-start-lab', token)
              });
            });
          };
          // Invoke immediately
          executeRecaptchaForStartLab()

          // Async variant so you can await this function from another async function (no need for
          // an explicit callback function then!)
          // Returns a Promise that resolves with the response token.
          async function executeRecaptchaForStartLabAsync() {
            return new Promise((resolve, reject) => {
              grecaptcha.ready(async function() {
                resolve(await grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}))
              });
            })
          };

                    var setInputWithRecaptchaResponseTokenForStartLab = function(id, token) {
            var element = document.getElementById(id);
            element.value = token;
          }

        </script>
<input type="hidden" name="g-recaptcha-response-data[start_lab]" id="g-recaptcha-response-data-start-lab" data-sitekey="6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr" class="g-recaptcha g-recaptcha-response "/>

<div class='hidden' id='recaptcha-v2-start-lab' slot='recaptcha'>
<script src="https://www.recaptcha.net/recaptcha/api.js" async defer ></script>
<div data-sitekey="6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV" data-callback="recaptchaComplete" data-expired-callback="expireV2Token" class="g-recaptcha "></div>
          <noscript>
            <div>
              <div style="width: 302px; height: 422px; position: relative;">
                <div style="width: 302px; height: 422px; position: absolute;">
                  <iframe
                    src="https://www.recaptcha.net/recaptcha/api/fallback?k=6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV"
                    name="ReCAPTCHA"
                    style="width: 302px; height: 422px; border-style: none; border: 0; overflow: hidden;">
                  </iframe>
                </div>
              </div>
              <div style="width: 300px; height: 60px; border-style: none;
                bottom: 12px; left: 25px; margin: 0px; padding: 0px; right: 25px;
                background: #f9f9f9; border: 1px solid #c1c1c1; border-radius: 3px;">
                <textarea id="g-recaptcha-response" name="g-recaptcha-response"
                  class="g-recaptcha-response"
                  style="width: 250px; height: 40px; border: 1px solid #c1c1c1;
                  margin: 10px 25px; padding: 0px; resize: none;">
                </textarea>
              </div>
            </div>
          </noscript>

</div>
</ql-lab-control-panel>
</ql-drawer>
<ql-drawer-content id='lab-instructions' slot='drawer-content'>
<div class='alert alert--fake js-alert'>
<p class='alert__message js-alert-message'></p>
<a class='alert__close js-alert-close'>
<i class='fa fa-times'></i>
</a>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='js-lab-content lab-content__renderable-instructions'>
<div class='lab-preamble'>
<h1 class='lab-preamble__title'>
Working with Google Kubernetes Engine Secrets and ConfigMaps
</h1>
<div class='lab-preamble__details subtitle-headline-1'>
<span>1 hour </span>
<span>Free</span>
<div class='lab__rating'>
<a href="/focuses/15531574/reviews?parent=lti_session"><div class='rateit' data-rateit-readonly='true' data-rateit-value='4.4261'></div>

</a><a data-target='#lab-review-modal' data-toggle='modal'>
Rate Lab
</a>
</div>
</div>
</div>

<div class='js-markdown-instructions markdown-lab-instructions' id='markdown-lab-instructions'>



<h2 id="step1">Overview</h2>
<p>In this lab, you set up configuration information, both encrypted and unencrypted. Encrypted configuration information is stored as secrets. Unencrypted configuration information is stored as ConfigMaps. This approach avoids hard coding such information into code bases. Credentials (like API keys) that belong in secrets should never travel inside code repositories like GitHub (unless they are encrypted before going in, but even then it is better to keep them separate).</p>
<h2 id="step2">Objectives</h2>
<p>In this lab, you learn how to perform the following tasks:</p>
<ul>
<li>
<p>Create secrets by using the <code>kubectl</code> command and manifest files</p>
</li>
<li>
<p>Create ConfigMaps by using the <code>kubectl</code> command and manifest files</p>
</li>
<li>
<p>Consume secrets in containers by using environment variables or mounted volumes</p>
</li>
<li>
<p>Consume ConfigMaps in containers by using environment variables or mounted volumes</p>
</li>
</ul>
<h2 id="step3">Task 0. Lab Setup</h2>
<h3><strong>Access Qwiklabs</strong></h3>
<p>For each lab, you get a new GCP project and set of resources for a fixed time at no cost.</p>
<ol>
<li>
<p>Make sure you signed into Qwiklabs using an <strong>incognito window</strong>.</p>
</li>
<li>
<p>Note the lab's access time (for example, <img alt="img/time.png" src="https://cdn.qwiklabs.com/aZQJ4BT7uCmM9XR6BTXgTRP1Hfu1T7q6V%2BcnbdEsbpU%3D"> and make sure you can finish in that time block.</p>
</li>
</ol>
<aside> <p>
  There is no pause feature. You can restart if needed, but you have to start at the beginning.
  </p>

</aside>
<ol start="3">
<li>
<p>When ready, click <img alt="img/start_lab.png" src="https://cdn.qwiklabs.com/XE8x7uvQokyubNwnYKKc%2BvBBNrMlo5iNZiDDzQQ3Ddo%3D">.</p>
</li>
<li>
<p>Note your lab credentials. You will use them to sign in to Cloud Platform Console.
<img alt="img/open_google_console.png" src="https://cdn.qwiklabs.com/0d78dhX6IVMVWmixCPPSBbmi5O2GPokCXf1Ps1AkTgI%3D"></p>
</li>
<li>
<p>Click <strong>Open Google Console</strong>.</p>
</li>
<li>
<p>Click <strong>Use another account</strong> and copy/paste credentials for <strong>this</strong> lab into the prompts.</p>
</li>
</ol>
<aside class="warning"><p>
  If you use other credentials, you'll get errors or <strong>incur charges</strong>.
  </p>
</aside>
<ol start="7">
<li>Accept the terms and skip the recovery resource page.</li>
</ol>
<aside class="warning"><p>
  Do not click <strong>End Lab</strong> unless you are finished with the lab or want to restart it. This clears your work and removes the project.
  </p>
</aside>

<p>After you complete the initial sign-in steps, the project dashboard appears.</p>
<h3>Activate Google Cloud Shell</h3>
<p>Google Cloud Shell is a virtual machine that is loaded with development tools. It offers a persistent 5GB home directory and runs on the Google Cloud.
Google Cloud Shell provides command-line access to your GCP resources.</p>
<ol>
<li>
<p>In GCP console, on the top right toolbar, click the Open Cloud Shell button.</p>
<p><img alt="Cloud Shell icon" src="https://cdn.qwiklabs.com/vdY5e%2Fan9ZGXw5a%2FZMb1agpXhRGozsOadHURcR8thAQ%3D"></p>
</li>
<li>
<p>Click <strong>Continue</strong>.
<img alt="cloudshell_continue.png" src="https://cdn.qwiklabs.com/lr3PBRjWIrJ%2BMQnE8kCkOnRQQVgJnWSg4UWk16f0s%2FA%3D"></p>
</li>
</ol>
<p>It takes a few moments to provision and connect to the environment. When you are connected, you are already authenticated, and the project is set to your <em>PROJECT_ID</em>. For example:</p>
<p><img alt="Cloud Shell Terminal" src="https://cdn.qwiklabs.com/hmMK0W41Txk%2B20bQyuDP9g60vCdBajIS%2B52iI2f4bYk%3D"></p>
<p><strong>gcloud</strong> is the command-line tool for Google Cloud Platform. It comes pre-installed on Cloud Shell and supports tab-completion.</p>
<p>You can list the active account name with this command:</p>
<pre><code>gcloud auth list&#x000A;</code></pre>
<p>Output:</p>
<pre><code class="language-output prettyprint">Credentialed accounts:&#x000A; - &lt;myaccount&gt;@&lt;mydomain&gt;.com (active)&#x000A;</code></pre>
<p>Example output:</p>
<pre><code class="language-Output prettyprint">Credentialed accounts:&#x000A; - google1623327_student@qwiklabs.net&#x000A;</code></pre>
<p>You can list the project ID with this command:</p>
<pre><code>gcloud config list project&#x000A;</code></pre>
<p>Output:</p>
<pre><code class="language-output prettyprint">[core]&#x000A;project = &lt;project_ID&gt;&#x000A;</code></pre>
<p>Example output:</p>
<pre><code class="language-Output prettyprint">[core]&#x000A;project = qwiklabs-gcp-44776a13dea667a6&#x000A;</code></pre>
<ql-infobox>
  Full documentation of <strong>gcloud</strong> is available on
  <a href="https://cloud.google.com/sdk/gcloud" target="_blank">
    Google Cloud gcloud Overview
  </a>.
</ql-infobox>

<h2 id="step4">Task 1. Work with Secrets</h2>
<p>In this task, you authenticate containers with Google Cloud in order to access Google Cloud services. You set up a Cloud Pub/Sub topic and subscription, try to access the Cloud Pub/Sub topic from a container running in GKE, and see that the access request fails. To properly access the pub/sub topic, you create a service account with credentials, and pass those credentials through Kubernetes Secrets.</p>
<h3><strong>Prepare a service account with no permissions</strong></h3>
<ol>
<li>
<p>In the Google Cloud Console, on the <strong>Navigation menu</strong> (<img alt="9a951fa6d60a98a5.png" src="https://cdn.qwiklabs.com/fXo8j8i%2FKJoMkZ7FeHUYU7Vvu2PQfFZtFbLISSnYEaY%3D">), click <strong>IAM &amp; admin</strong> &gt; <strong>Service accounts</strong>.</p>
</li>
<li>
<p>Click <strong>+ Create Service Account</strong>.</p>
</li>
<li>
<p>In the <strong>Service Account Name</strong> text box, enter <code>no-permissions</code> and then click <strong>Create</strong>.</p>
</li>
<li>
<p>Click <strong>Continue</strong> and then click <strong>Done</strong>.</p>
</li>
<li>
<p>Find the <strong>no-permissions</strong> service account in the list, and copy the email address associated with it to a text file for later use.</p>
</li>
</ol>
<h3><strong>Create a GKE cluster</strong></h3>
<p>When you create this cluster you will specify the service account you created earlier. To illustrate the need for service accounts with proper permissions, that service account has no permissions to any other Google Cloud services, and therefore will be unable to connect to the Cloud Pub/Sub test application you will later deploy. You will fix this later in the lab.</p>
<ol>
<li>
<p>In Cloud Shell, type the following command to create environment variables for the Google Cloud zone and cluster name that will be used to create the cluster for this lab.</p>
</li>
</ol>
<pre><code>export my_zone=us-central1-a&#x000A;export my_cluster=standard-cluster-1&#x000A;</code></pre>
<ol start="2">
<li>
<p>Configure tab completion for the  kubectl command-line tool.</p>
</li>
</ol>
<pre><code>source &lt;(kubectl completion bash)&#x000A;</code></pre>
<ol start="3">
<li>
<p>In Cloud Shell, type the following command to set the environment variable for the service account name, where<code>[MY-SERVICE-ACCOUNT-EMAIL]</code> is the email address of the service account that you created earlier.</p>
</li>
</ol>
<pre><code>export my_service_account=[MY-SERVICE-ACCOUNT-EMAIL]&#x000A;</code></pre>
<p><strong>Example (Do not copy):</strong></p>
<pre><code>export my_service_account=no-permissions@qwiklabs-gcp-4ee5983fdd675469.iam.gserviceaccount.com&#x000A;</code></pre>
<ol start="4">
<li>
<p>In Cloud Shell, type the following command to create a Kubernetes cluster.</p>
</li>
</ol>
<pre><code>gcloud container clusters create $my_cluster \&#x000A;  --num-nodes 2 --zone $my_zone \&#x000A;  --service-account=$my_service_account&#x000A;</code></pre>
<ql-infobox><strong>Note:</strong> You need to wait a few minutes for the cluster deployment to complete.</ql-infobox>
<ol start="5">
<li>
<p>Configure access to your cluster for kubectl:</p>
</li>
</ol>
<pre><code>gcloud container clusters get-credentials $my_cluster --zone $my_zone&#x000A;</code></pre>
<h3><strong>Set up Cloud Pub/Sub and deploy an application to read from the topic</strong></h3>
<ol>
<li>
<p>In Cloud Shell, type the following command to set the environment variables for the pub/sub components.</p>
</li>
</ol>
<pre><code>export my_pubsub_topic=echo&#x000A;export my_pubsub_subscription=echo-read&#x000A;</code></pre>
<ol start="2">
<li>
<p>To create a Cloud Pub/Sub topic named echo and a subscription named echo-read that is associated with that topic, execute the following <code>gcloud</code> commands:</p>
</li>
</ol>
<pre><code>gcloud pubsub topics create $my_pubsub_topic&#x000A;gcloud pubsub subscriptions create $my_pubsub_subscription \&#x000A; --topic=$my_pubsub_topic&#x000A;</code></pre>
<h3><strong>Deploy an application to read from Cloud Pub/Sub topics</strong></h3>
<p>You create a deployment with a container that can read from Cloud Pub/Sub topics. Since specific permissions are required to subscribe to, and read from, Cloud Pub/Sub topics this container needs to be provided with credentials in order to successfully connect to Cloud Pub/Sub.</p>
<p>The Deployment manifest file called  <code>pubsub.yaml</code> is provided for you.</p>
<pre><code>apiVersion: apps/v1&#x000A;kind: Deployment&#x000A;metadata:&#x000A;  name: pubsub&#x000A;spec:&#x000A;  selector:&#x000A;    matchLabels:&#x000A;      app: pubsub&#x000A;  template:&#x000A;    metadata:&#x000A;      labels:&#x000A;        app: pubsub&#x000A;    spec:&#x000A;      containers:&#x000A;      - name: subscriber&#x000A;        image: gcr.io/google-samples/pubsub-sample:v1&#x000A;</code></pre>
<ol>
<li>
<p>In Cloud Shell enter the following command  to clone the repository to the lab Cloud Shell.</p>
</li>
</ol>
<pre><code>git clone https://github.com/GoogleCloudPlatform/training-data-analyst&#x000A;</code></pre>
<ol start="2">
<li>
<p>Create a soft link as a shortcut to the working directory.</p>
</li>
</ol>
<pre><code>ln -s ~/training-data-analyst/courses/ak8s/v1.1 ~/ak8s&#x000A;</code></pre>
<ol start="3">
<li>
<p>Change to the directory that contains the sample files for this lab.</p>
</li>
</ol>
<pre><code>cd ~/ak8s/Secrets/&#x000A;</code></pre>
<ol start="4">
<li>
<p>Deploy the application.</p>
</li>
</ol>
<pre><code>kubectl apply -f pubsub.yaml&#x000A;</code></pre>
<ol start="5">
<li>
<p>After the application is deployed, query the Pods by executing the following command:</p>
</li>
</ol>
<pre><code>kubectl get pods -l app=pubsub&#x000A;</code></pre>
<p>This command filters the list of Pods, only including those that have a matching label of <code>app: pubsub</code>.</p>
<p><strong>Output (Do not copy):</strong></p>
<pre><code>NAME                      READY     STATUS              RESTARTS   AGE&#x000A;pubsub-74d4d96ddb-lqkt8   0/1       CrashLoopBackOff   0          6s&#x000A;</code></pre>
<ql-infobox><strong>Note:</strong> You need to wait for about a minute. The application is starting, but it will not succeed.</ql-infobox>
<ol start="6">
<li>
<p>List the Pods again:</p>
</li>
</ol>
<pre><code>kubectl get pods -l app=pubsub&#x000A;</code></pre>
<p><strong>Output (Do not copy):</strong></p>
<pre><code>NAME                      READY     STATUS    RESTARTS   AGE&#x000A;pubsub-74d4d96ddb-lqkt8   0/1       Error     4          2m&#x000A;</code></pre>
<p>Notice the status of the Pod. It has an error and has restarted several times.</p>
<ol start="7">
<li>
<p>To inspect the logs from the Pod, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl logs -l app=pubsub&#x000A;</code></pre>
<p>The error message displayed at the end of the log indicates that the application doesn't have permissions to query the Cloud Pub/Sub service.</p>
<pre><code>StatusCode.PERMISSION_DENIED, User not authorized to perform this action.&#x000A;</code></pre>
<h3><strong>Create service account credentials</strong></h3>
<p>You will now create a new service account and grant it access to the pub/sub subscription that the test application is attempting to use. Instead of changing the service account of the GKE cluster nodes, you will generate a JSON key for the service account, and then securely pass the JSON key to the Pod via Kubernetes Secrets.</p>
<ol>
<li>
<p>In the Google Cloud Console, on the <strong>Navigation menu</strong>, click <strong>IAM &amp; admin</strong> &gt; <strong>Service Accounts</strong>.</p>
</li>
<li>
<p>Click <strong>+ Create Service Account</strong>.</p>
</li>
<li>
<p>In the <strong>Service Account Name</strong> text box, enter <code>pubsub-app</code> and then click <strong>Create</strong>.</p>
</li>
<li>
<p>In the <strong>Role</strong> drop-down list, select <strong>Pub/Sub &gt; Pub/Sub Subscriber</strong>.</p>
</li>
<li>
<p>Confirm the role is listed, and then click <strong>Continue.</strong> and then click <strong>Done</strong>.</p>
</li>
<li>
<p>In the Service Account overview screen, click the three dots on the right hand side of the <code>pubsub-app</code> service account, then select <strong>+ Create Key</strong>.</p>
</li>
<li>
<p>Select <strong>JSON</strong> as the key type, and then click <strong>Create</strong>.</p>
</li>
<li>
<p>A JSON key file containing the credentials of the service account will download to your computer. You can see the file in the download bar at the bottom of your screen. You will use this key file to configure the sample application to authenticate to Cloud Pub/Sub API.</p>
</li>
<li>
<p>Click <strong>Close</strong> and then click <strong>Done</strong>.</p>
</li>
<li>
<p>On your hard drive, locate the JSON key that you just downloaded and rename the file to <code>credentials.json</code>.</p>
</li>
</ol>
<h3><strong>Import credentials as a secret</strong></h3>
<ol>
<li>In Cloud Shell, click the three dots ( <img alt="b4af82f98f85f64f.png" src="https://cdn.qwiklabs.com/5OEwfJEfsSg8zDSsYjmqhsK7fRiAcDrW50FJ0Axw%2Fk8%3D">) icon in the Cloud Shell toolbar to display further options.</li>
</ol>
<p><img alt="8c6d3554108c8912.png" src="https://cdn.qwiklabs.com/MmUXLL7zLY0GNWCC%2FdOCrczwKSgrYKLbMxmyDanWlfQ%3D"></p>
<ol start="2">
<li>
<p>Click <strong>Upload file</strong> and upload the <code>credentials.json</code> file from your local machine to the Cloud Shell VM.</p>
</li>
<li>
<p>In Cloud Shell, enter the following command to confirm that the file was uploaded.</p>
</li>
</ol>
<pre><code>ls ~/&#x000A;</code></pre>
<p>You should see the credentials file that has been uploaded along with the lab files directory you cloned earlier.</p>
<ol start="4">
<li>
<p>To save the <code>credentials.json</code> key file to a Kubernetes Secret named <code>pubsub-key</code>  execute the following command.</p>
</li>
</ol>
<pre><code>kubectl create secret generic pubsub-key \&#x000A; --from-file=key.json=$HOME/credentials.json&#x000A;</code></pre>
<p>This command creates a secret named <code>pubsub-key</code> that has a <code>key.json</code> value containing the contents of the private key that you downloaded from the Google Cloud Console.</p>
<ol start="5">
<li>
<p>Remove the <code>credentials.json</code> file from your computer.</p>
</li>
</ol>
<pre><code>rm -rf ~/credentials.json&#x000A;</code></pre>
<h3><strong>Configure the application with the secret</strong></h3>
<p>You now update the deployment to include the following changes:</p>
<ul>
<li>Add a volume to the Pod specification. This volume contains the secret.</li>
<li>The secrets volume is mounted in the application container.</li>
<li>The <code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable is set to point to the key file in the secret volume mount.</li>
</ul>
<p>The  <code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable is automatically recognized by Cloud Client Libraries, in this case, the Cloud Pub/Sub client for Python.</p>
<p>The updated Deployment file called <code>pubsub-secret.yaml</code> has been provided for you.</p>
<pre><code>apiVersion: apps/v1&#x000A;kind: Deployment&#x000A;metadata:&#x000A;  name: pubsub&#x000A;spec:&#x000A;  selector:&#x000A;    matchLabels:&#x000A;      app: pubsub&#x000A;  template:&#x000A;    metadata:&#x000A;      labels:&#x000A;        app: pubsub&#x000A;    spec:&#x000A;      volumes:&#x000A;      - name: google-cloud-key&#x000A;        secret:&#x000A;          secretName: pubsub-key&#x000A;      containers:&#x000A;      - name: subscriber&#x000A;        image: gcr.io/google-samples/pubsub-sample:v1&#x000A;        volumeMounts:&#x000A;        - name: google-cloud-key&#x000A;          mountPath: /var/secrets/google&#x000A;        env:&#x000A;        - name: GOOGLE_APPLICATION_CREDENTIALS&#x000A;          value: /var/secrets/google/key.json&#x000A;</code></pre>
<ol>
<li>
<p>Deploy the <code>pubsub-secret.yaml</code> configuration file.</p>
</li>
</ol>
<pre><code>kubectl apply -f pubsub-secret.yaml&#x000A;</code></pre>
<ol start="2">
<li>After the configuration is deployed, execute the following command to display the Pod status.</li>
</ol>
<p>The Pod status should be <em>Running</em>. The status change might take several seconds to appear.</p>
<pre><code>kubectl get pods -l app=pubsub&#x000A;</code></pre>
<p><strong>Output (Do not copy):</strong></p>
<pre><code>NAME                      READY     STATUS        RESTARTS   AGE&#x000A;pubsub-c4f48b868-xk27w    1/1       Running       0          35s&#x000A;</code></pre>
<h3><strong>Test receiving Cloud Pub/Sub messages</strong></h3>
<ol>
<li>
<p>Now that you configured the application, publish a message to the Cloud Pub/Sub topic you created earlier in the lab.</p>
</li>
</ol>
<pre><code>gcloud pubsub topics publish $my_pubsub_topic --message="Hello, world!"&#x000A;</code></pre>
<p><strong>Output (Do not copy): Your message ID will differ.</strong></p>
<pre><code>messageIds:&#x000A;- '328977244395410'&#x000A;</code></pre>
<p>Within a few seconds, the message should be picked up by the application and printed to the output stream.</p>
<ol start="2">
<li>
<p>To inspect the logs from the deployed Pod, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl logs -l app=pubsub&#x000A;</code></pre>
<p>The output should look like the example.</p>
<p><strong>Output (do not copy)</strong></p>
<pre><code>Pulling messages from Pub/Sub subscription...&#x000A;[2018-12-17 22:01:06.860378] Received message: ID=328977244395410 Data=b'Hello, world!'&#x000A;[2018-12-17 22:01:06.860736] Processing: 328977244395410&#x000A;[2018-12-17 22:01:09.863973] Processed: 328977244395410&#x000A;</code></pre>
<p>Click Check my progress to verify the objective.</p>
<ql-activity-tracking step="1">
      Work with Secrets
  </ql-activity-tracking>
<h2 id="step5">Task 2. Work with ConfigMaps</h2>
<p>ConfigMaps bind configuration files, command-line arguments, environment variables, port numbers, and other configuration artifacts to your Pods' containers and system components at runtime. ConfigMaps enable you to separate your configurations from your Pods and components. But ConfigMaps aren't encrypted, making them inappropriate for credentials. This is the difference between secrets and ConfigMaps: secrets are encrypted and are therefore better suited for confidential or sensitive information such as credentials. ConfigMaps are better suited for general configuration information such as port numbers.</p>
<h3>Use the kubectl command to create ConfigMaps</h3>
<p>You use <code>kubectl</code> to create ConfigMaps by following the pattern <code>kubectl create configmap [NAME] [DATA]</code> and adding a flag for file (<code>--from-file</code>) or literal (<code>--from-literal</code>).</p>
<ol>
<li>
<p>Start with a simple literal in the following <code>kubectl</code> command:</p>
</li>
</ol>
<pre><code>kubectl create configmap sample --from-literal=message=hello&#x000A;</code></pre>
<ol start="2">
<li>
<p>To see how Kubernetes ingested the ConfigMap, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl describe configmaps sample&#x000A;</code></pre>
<p>The output should look like the example.</p>
<p><strong>Output (do not copy)</strong></p>
<pre><code>Name:         sample&#x000A;Namespace:    default&#x000A;Labels:       &lt;none&gt;&#x000A;Annotations:  &lt;none&gt;&#x000A;&#x000A;Data&#x000A;====&#x000A;message:&#x000A;----&#x000A;hello&#x000A;Events:  &lt;none&gt;&#x000A;</code></pre>
<p>Next you will create a ConfigMap from a file. The file <code>sample2.properties</code> has been provided for you and contains some sample data:</p>
<p><strong>do not copy</strong></p>
<pre><code>message2=world&#x000A;foo=bar&#x000A;meaningOfLife=42&#x000A;</code></pre>
<ol start="3">
<li>
<p>To create the ConfigMap from <code>sample2.properties</code>, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl create configmap sample2 --from-file=sample2.properties&#x000A;</code></pre>
<ol start="4">
<li>
<p>To see how Kubernetes ingested the ConfigMap, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl describe configmaps sample2&#x000A;</code></pre>
<p>The output should look like the example.</p>
<p><strong>Output (do not copy)</strong></p>
<pre><code>Name:         sample2&#x000A;Namespace:    default&#x000A;Labels:       &lt;none&gt;&#x000A;Annotations:  &lt;none&gt;&#x000A;&#x000A;Data&#x000A;====&#x000A;sample2.properties:&#x000A;----&#x000A;message2=world&#x000A;foo=bar&#x000A;meaningOfLife=42&#x000A;&#x000A;Events:  &lt;none&gt;&#x000A;</code></pre>
<h3><strong>Use manifest files to create ConfigMaps</strong></h3>
<p>You can also use a YAML configuration file to create a ConfigMap. The <code>config-map-3.yaml</code> file contains a ConfigMap definition called <code>sample3</code>. You will use this ConfigMap later to demonstrate two different ways to expose the data inside a container.</p>
<pre><code>apiVersion: v1&#x000A;data:&#x000A;  airspeed: africanOrEuropean&#x000A;  meme: testAllTheThings&#x000A;kind: ConfigMap&#x000A;metadata:&#x000A;  name: sample3&#x000A;  namespace: default&#x000A;  selfLink: /api/v1/namespaces/default/configmaps/sample3&#x000A;</code></pre>
<ol>
<li>
<p>Create the ConfigMap from the YAML file:</p>
</li>
</ol>
<pre><code>kubectl apply -f config-map-3.yaml&#x000A;</code></pre>
<ol start="2">
<li>
<p>To see how Kubernetes ingested the ConfigMap, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl describe configmaps sample3&#x000A;</code></pre>
<p>The output should look like the example.</p>
<p><strong>Output (do not copy)</strong></p>
<pre><code>Name:         sample3&#x000A;Namespace:    default&#x000A;Labels:       &lt;none&gt;&#x000A;Annotations:  kubectl.kubernetes.io/last-applied-configuration:&#x000A;                {"apiVersion":"v1","data":{"airspeed":"africanOrEuropean","meme":"testAllTheThings"},"kind":"ConfigMap","metadata":{"annotations":{&#x000A;},"name...&#x000A;&#x000A;Data&#x000A;====&#x000A;airspeed:&#x000A;----&#x000A;africanOrEuropean&#x000A;meme:&#x000A;----&#x000A;testAllTheThings&#x000A;Events:  &lt;none&gt;&#x000A;</code></pre>
<p>Now you have some non secret, unencrypted, configuration information properly separated from your application and available to your cluster. You've performed this task using ConfigMaps in three different ways to demonstrate the various options, but in practice you typically pick one method, most likely the YAML configuration file approach. Configuration files provide a record of the values that you've stored so that you can easily repeat the process in the future.</p>
<p>Next, you'll learn how to access this information from within your application.</p>
<h3><strong>Use environment variables to consume ConfigMaps in containers</strong></h3>
<p>In order to access ConfigMaps from inside Containers using environment variables the Pod definition must be updated to include one or more <code>configMapKeyRefs</code>. The file <code>pubsub-configmap.yaml</code> is an updated version of the Cloud Pub/Sub demo Deployment that includes the following additional <code>env:</code> setting at the end of the file to import environmental variables from the ConfigMap into the container.</p>
<pre><code>        - name: INSIGHTS&#x000A;          valueFrom:&#x000A;            configMapKeyRef:&#x000A;              name: sample3&#x000A;              key: meme&#x000A;</code></pre>
<ol>
<li>
<p>To reapply the updated configuration file, execute the following command:</p>
</li>
</ol>
<pre><code>kubectl apply -f pubsub-configmap.yaml&#x000A;</code></pre>
<p>Now your application has access to an environment variable called <code>INSIGHTS</code>, which has a value of <code>testAllTheThings</code>.</p>
<ol start="2">
<li>
<p>To verify that the environment variable has the correct value, you must gain shell access to your Pod, which means that you need the name of your Pod. To get the name of the Pod, execute the following the command:</p>
</li>
</ol>
<pre><code>kubectl get pods&#x000A;</code></pre>
<p>The output should look like the example.</p>
<p><strong>Output (do not copy)</strong></p>
<pre><code>NAME                     READY     STATUS    RESTARTS   AGE&#x000A;pubsub-77df8f8c6-krfl2   1/1       Running   0          4m&#x000A;</code></pre>
<ol start="3">
<li>
<p>To start the shell session, execute the following command, substituting the name of your Pod for <code>[MY-POD-NAME]</code>:</p>
</li>
</ol>
<pre><code>kubectl exec -it [MY-POD-NAME] -- sh&#x000A;</code></pre>
<p><strong>Example (do not copy)</strong></p>
<pre><code>kubectl exec -it pubsub-77df8f8c6-krfl2 -- sh&#x000A;</code></pre>
<ol start="4">
<li>
<p>To print a list of environment variables, execute the following command:</p>
</li>
</ol>
<pre><code>printenv&#x000A;</code></pre>
<p><code>INSIGHTS=testAllTheThings</code> should appear in the list.</p>
<ol start="5">
<li>
<p>To exit the container's shell session, execute the following command:</p>
</li>
</ol>
<pre><code>exit&#x000A;</code></pre>
<h3><strong>Use mounted volumes to consume ConfigMaps in containers</strong></h3>
<p>You can populate a volume with the ConfigMap data instead of (or in addition to) storing it in an environment variable.</p>
<p>In this Deployment the ConfigMap named <code>sample-3</code> that you created earlier in this task is also added as a volume called <code>config-3</code> in the Pod spec. The <code>config-3</code> volume is then mounted inside the container on the path <code>/etc/config</code>. The original method using Environment variables to import ConfigMaps is also configured.</p>
<p>The updated Deployment file called <code>pubsub-configmap2.yaml</code> has been provided for you.</p>
<pre><code>apiVersion: apps/v1&#x000A;kind: Deployment&#x000A;metadata:&#x000A;  name: pubsub&#x000A;spec:&#x000A;  selector:&#x000A;    matchLabels:&#x000A;      app: pubsub&#x000A;  template:&#x000A;    metadata:&#x000A;      labels:&#x000A;        app: pubsub&#x000A;    spec:&#x000A;      volumes:&#x000A;      - name: google-cloud-key&#x000A;        secret:&#x000A;          secretName: pubsub-key&#x000A;      - name: config-3&#x000A;        configMap:&#x000A;          name: sample3&#x000A;      containers:&#x000A;      - name: subscriber&#x000A;        image: gcr.io/google-samples/pubsub-sample:v1&#x000A;        volumeMounts:&#x000A;        - name: google-cloud-key&#x000A;          mountPath: /var/secrets/google&#x000A;        - name: config-3&#x000A;          mountPath: /etc/config&#x000A;        env:&#x000A;        - name: GOOGLE_APPLICATION_CREDENTIALS&#x000A;          value: /var/secrets/google/key.json&#x000A;        - name: INSIGHTS&#x000A;          valueFrom:&#x000A;            configMapKeyRef:&#x000A;              name: sample3&#x000A;              key: meme&#x000A;</code></pre>
<ol>
<li>
<p>Reapply the updated configuration file.</p>
</li>
</ol>
<pre><code>kubectl apply -f pubsub-configmap2.yaml&#x000A;</code></pre>
<ol start="2">
<li>
<p>Reconnect to the container's shell session to see if the value in the ConfigMap is accessible. The Pod names will have changed. To get the name of the Pod, execute the following the command:</p>
</li>
</ol>
<pre><code>kubectl get pods&#x000A;</code></pre>
<p>The output should look like the example.</p>
<p><strong>Output (do not copy)</strong></p>
<pre><code>NAME                      READY     STATUS    RESTARTS   AGE&#x000A;pubsub-747cf8c545-ngsrf   1/1       Running   0          30s&#x000A;pubsub-df6bc7b87-vb8cz    1/1    Terminating  0          4m     &#x000A;</code></pre>
<ol start="3">
<li>
<p>To start the shell session, execute the following command, substituting the name of your Pod for <code>[MY-POD-NAME]</code>:</p>
</li>
</ol>
<pre><code>kubectl exec -it [MY-POD-NAME] -- sh&#x000A;</code></pre>
<p><strong>Example (do not copy)</strong></p>
<pre><code>kubectl exec -it pubsub-747cf8c545-ngsrf -- sh&#x000A;</code></pre>
<ol start="4">
<li>
<p>Navigate to the appropriate folder.</p>
</li>
</ol>
<pre><code>cd /etc/config&#x000A;</code></pre>
<ol start="5">
<li>List the files in the folder.</li>
</ol>
<p>The filenames as keys from <code>sample3</code> should be listed.</p>
<pre><code>ls&#x000A;</code></pre>
<p><strong>Output (do not copy)</strong></p>
<pre><code>airspeed  meme&#x000A;</code></pre>
<ol start="6">
<li>
<p>To view the contents of one of the files, execute the following command:</p>
</li>
</ol>
<pre><code>cat airspeed&#x000A;</code></pre>
<p><strong>Output (Do not copy):</strong></p>
<pre><code>africanOrEuropean#&#x000A;</code></pre>
<p>Note that the value of airspeed did not include a carriage return, therefore the command prompt (the # sign) is at the end of the returned value.</p>
<ol start="7">
<li>
<p>To exit the container's shell, execute the following command:</p>
</li>
</ol>
<pre><code>exit&#x000A;</code></pre>
<p>Click Check my progress to verify the objective.</p>
<ql-activity-tracking step="2">
      Work with ConfigMaps
  </ql-activity-tracking>
<h2 id="step6">End your lab</h2>
<p>When you have completed your lab, click <strong>End Lab</strong>. Qwiklabs removes the resources you’ve used and cleans the account for you.</p>
<p>You will be given an opportunity to rate the lab experience. Select the applicable number of stars, type a comment, and then click <strong>Submit</strong>.</p>
<p>The number of stars indicates the following:</p>
<ul>
<li>1 star = Very dissatisfied</li>
<li>2 stars = Dissatisfied</li>
<li>3 stars = Neutral</li>
<li>4 stars = Satisfied</li>
<li>5 stars = Very satisfied</li>
</ul>
<p>You can close the dialog box if you don't want to provide feedback.</p>
<p>For feedback, suggestions, or corrections, please use the <strong>Support</strong> tab.</p>

<p>Copyright 2021 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>



</div>
</div>


<div class='hidden js-end-lab-button-container lab-content__end-lab-button'>
<ql-lab-control-button class='js-end-lab-button' running></ql-lab-control-button>
</div>
<!-- / TODO: Move recommendations into the end lab modal -->
</ql-drawer-content>
<ql-drawer end id='outline-drawer' open slot='drawer' width='320'>
<div class='js-lab-content-outline lab-content__outline'>
<a href='#step1'>Overview</a><a href='#step2'>Objectives</a><a href='#step3'>Task 0. Lab Setup</a><a href='#step4'>Task 1. Work with Secrets</a><a href='#step5'>Task 2. Work with ConfigMaps</a><a href='#step6'>End your lab</a>
</div>
</ql-drawer>
</ql-drawer-container>
</ql-drawer-content>
</ql-drawer-container>
<div class='lab-introduction js-lab-introduction is-hidden'>
<div class='lab-introduction__inner'>
<h1 class='headline-1'>Welcome to Your First Lab!</h1>
<ql-icon-button class='js-skip-button'>close</ql-icon-button>
<div class='lab-introduction__video'>
<iframe allow='autoplay; encrypted-media' allowfullscreen frameborder='0' id='lab-introduction' src='https://www.youtube.com/embed/yF7EDXKTmoQ?enablejsapi=1&amp;rel=0&amp;showinfo=0'></iframe>
</div>
<a class='js-skip-button button button--outline'>Skip this video</a>
</div>
</div>



</div>
</main>


<div class='modal fade' id='lab-details-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<div class='modal-body'>
<p class='l-mbm'>
Architecting with Google Kubernetes Engine: Working with Kubernetes Engine Secrets and ConfigMaps
</p>
<p class='small-label l-mbs'>
<strong>
Duration:
</strong>
0m setup
&middot;
60m access
&middot;
60m completion
</p>
<p class='small-label l-mbs'>
<span><strong>Levels: </strong>fundamental</span>
</p>
<p class='small-label'>
<strong>
Permalink:
</strong>
<a href="https://googlecoursera.qwiklabs.com/catalog_lab/2304">https://googlecoursera.qwiklabs.com/catalog_lab/2304</a>
</p>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Got It
</a>
</div>


</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>
<div class='modal fade' id='lab-review-modal'>
<div class='modal-container'>
<div class='mdl-shadow--24dp modal-content'>
<form class="simple_form js-lab-review-form" id="edit_lab_review_11168010" action="/lab_reviews/11168010" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="_method" value="patch" /><div class='modal-body'>
<p class='label'>
How satisfied are you with this lab?*
</p>
<div class='rateit js-rateit' data-rateit-max='5' data-rateit-min='0' data-rateit-resetable='false' data-rateit-step='1' data-rateit-value='5'></div>
<div class='l-mtm'>

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="3894861" name="lab_review[user_id]" id="lab_review_user_id" /></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[classroom_id]" id="lab_review_classroom_id" /></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="2304" name="lab_review[lab_id]" id="lab_review_lab_id" /></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[focus_id]" id="lab_review_focus_id" /></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" value="2" name="lab_review[rating]" id="lab_review_rating" /></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Comment</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment">
</textarea></div></div>
</div>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Cancel
</a>
<input type="submit" name="commit" value="Submit" disabled="disabled" id="submit" data-disabled="false" class="button" data-disable-with="Submit" />
</div>
</form>

</div>
</div>
<iframe class='l-ie-iframe-fix'></iframe>
</div>


<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    ql.labControlPanel.addRecaptchaErrorHandler();
  initLabContent();
  ql.labOutline.links.init();
  initLabReviewModal();
  ql.labAssessment.init();
  ql.labIntroduction.init( true );
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?\n","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.\n","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.chat.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>

</body>
</html>

